\hypertarget{class_tree}{}\section{CoalescenceTree Class Reference}
\label{class_tree}\index{CoalescenceTree@{CoalescenceTree}}


Represents the output phylogenetic tree.  




{\ttfamily \#include $<$CoalescenceTree.\+h$>$}



Inheritance diagram for CoalescenceTree\+:
% FIG 0


Collaboration diagram for CoalescenceTree\+:
% FIG 1
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_tree_ad376a7c639d857312f5de2ef47482f68}{CoalescenceTree} ()
\begin{DoxyCompactList}\small\item\em The constructor for the tree object. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a46fbbf6c52f7b2bfebb1ae0aac4df724}{import\+Simulation\+Variables} (vector$<$ string $>$ \&comargs)
\begin{DoxyCompactList}\small\item\em Import the simulation variables from the command line structure. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a8efc9557eb11e41dfdfd7c2c83682e06}{import\+Simulation\+Variables} (string config\+\_\+file)
\begin{DoxyCompactList}\small\item\em Import the simulations variables from the specified config file. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a518a17560e8550c650f3a76718580ff5}{parse\+Args} (vector$<$ string $>$ \&comargs)
\begin{DoxyCompactList}\small\item\em Parses the command line arguments and saves the flags in \hyperlink{class_tree}{CoalescenceTree} for fullmode, resuming and other important variables. \end{DoxyCompactList}\item
void \hyperlink{class_tree_a322dfcd92942d2143fb3a9e70b81e026}{check\+Folders} ()\hypertarget{class_tree_a322dfcd92942d2143fb3a9e70b81e026}{}\label{class_tree_a322dfcd92942d2143fb3a9e70b81e026}

\begin{DoxyCompactList}\small\item\em Checks that the folders exist and the files required for the simulation also exist. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_ad0bcc474a9ab1d4e3e2458c4de7304ad}{check\+Sims} ()
\begin{DoxyCompactList}\small\item\em Checks for existing paused simulations to resume from Sets b\+Paused if there are. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_aafaede1da6c79583bf2e28b7a1881a5c}{check\+Sims} (string output\+\_\+dir, long seed, long task)
\begin{DoxyCompactList}\small\item\em Checks for existing paused simulations to resume from. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_ac374d237b7e2e7e11f6a0ff395003635}{set\+Parameters} ()
\begin{DoxyCompactList}\small\item\em Sets the map object with the correct variables, taking the \hyperlink{struct_sim_parameters}{Sim\+Parameters} structure defined elsewhere for the parameters. \end{DoxyCompactList}\item 
vector$<$ double $>$ \hyperlink{class_tree_ac03c034a5730ee4f4d8727aace776412}{get\+Temporal\+Sampling} ()\hypertarget{class_tree_ac03c034a5730ee4f4d8727aace776412}{}\label{class_tree_ac03c034a5730ee4f4d8727aace776412}

\begin{DoxyCompactList}\small\item\em Gets the map autocorrel times. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a8e60e04be160c2d7de0ab1c834e6a95b}{import\+Maps} ()
\begin{DoxyCompactList}\small\item\em Imports the maps into the forestmap object. \end{DoxyCompactList}\item 
long long \hyperlink{class_tree_a857521315ca6bd9b3300d099488d74f1}{get\+Seed} ()
\begin{DoxyCompactList}\small\item\em Getter for the simulation seed. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a65f098693e08e33f039a8797ba57c3e0}{set\+Seed} (long long theseedin)
\begin{DoxyCompactList}\small\item\em Sets the simulation seed to the provided variable. \end{DoxyCompactList}\item 
bool \hyperlink{class_tree_a839ff291e97962d1aaed4d785f394a89}{getb\+Paused} ()
\begin{DoxyCompactList}\small\item\em Gets the b\+Paused variable for resuming sims. \end{DoxyCompactList}\item 
vector$<$ long $>$ \hyperlink{class_tree_a27bd274fe727892c84d153d9bd5ddbf0}{random\+List} (long maxnum, long numnum)
\begin{DoxyCompactList}\small\item\em Deprecated function which generated a random list. \end{DoxyCompactList}\item 
unsigned long \hyperlink{class_tree_a869ab0aba75336f737cbb137c74b8abc}{set\+Object\+Sizes} ()
\begin{DoxyCompactList}\small\item\em Sets the sizes of grid, active and data, based on the number of individuals counted from the samplemask. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_ac31286aee0516ed9104aee4dde5a0651}{setup\+Dispersal\+Coordinator} ()\hypertarget{class_tree_ac31286aee0516ed9104aee4dde5a0651}{}\label{class_tree_ac31286aee0516ed9104aee4dde5a0651}

\begin{DoxyCompactList}\small\item\em Sets up the dispersal coordinator by linking to the correct functions and choosing the appropriate dispersal method. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_aec10ea2b720edc13a38310afdfe2b6e4}{setup} ()
\begin{DoxyCompactList}\small\item\em The setup function for generating the simulation objects. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a351650bda95319b2213c2234fa930f49}{remove\+Old\+Pos} (const unsigned long \&chosen)
\begin{DoxyCompactList}\small\item\em Removes the old position within active by checking any wrapping and removing connections. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_afeb039e194f964582905951f510b096c}{calc\+Move} (\hyperlink{struct_step}{Step} \&this\+\_\+step)
\begin{DoxyCompactList}\small\item\em Calculate the move, given a start x,y coordinates and wrapping. \end{DoxyCompactList}\item 
long double \hyperlink{class_tree_a70a652ff4273d83e642257e4f5b5dd47}{calc\+Min\+Max} (const unsigned long \&current)
\begin{DoxyCompactList}\small\item\em Calculates the minmax for a given branch. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a16eedb70009e7570d933f88e8ce44117}{coalescence\+Event} (const unsigned long \&chosen, unsigned long \&coalchosen)
\begin{DoxyCompactList}\small\item\em Perform the coalescence between lineages. Once coalesced, lineages are removed from the active scope. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a05a0e0f5f70d2763f9dad3bd54618c62}{calc\+New\+Pos} (bool \&coal, const unsigned long \&chosen, unsigned long \&coalchosen, const long \&oldx, const long \&oldy, const long \&oldxwrap, const long \&oldywrap)
\begin{DoxyCompactList}\small\item\em Calculates the new position, checking whether coalescence has occured and with which lineage. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a89e2fa28e3d637b4bc034fb3afc53e81}{switch\+Positions} (const unsigned long chosen)
\begin{DoxyCompactList}\small\item\em Switches the chosen position with the endactive position. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a05c9e44f1a4d7af83e65b6c4565b1b28}{speciation} (const unsigned long \&chosen)
\begin{DoxyCompactList}\small\item\em Speciation to supplied lineage. \end{DoxyCompactList}\item 
virtual bool \hyperlink{class_tree_a0a6fd214c1e4b77955add6ffa9f76d5d}{calc\+Speciation} (const long double \&random\+\_\+number, const long double \&speciation\+\_\+rate, const int \&no\+\_\+generations)
\begin{DoxyCompactList}\small\item\em Calculates the speciation probability from the random number, speciation rate and number of generations a lineage has existed for. \end{DoxyCompactList}\item 
unsigned long \hyperlink{class_tree_a8f4c4cbc5ad516f0fde489c9a826e676}{est\+Specnum} ()
\begin{DoxyCompactList}\small\item\em Estimates the species number from the second largest minimum speciation rate remaining in active. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a3820405a51ac9043346d37b0e267d364}{run\+Checks} (const unsigned long \&chosen, const unsigned long \&coalchosen)
\begin{DoxyCompactList}\small\item\em Run checks at the end of each cycle which make certain the move has been successful. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_aa60dbbf173231fb224e2c6792cbae292}{validation\+Check} (const unsigned long \&chosen, int o, const unsigned long \&current, const bool \&coal)
\begin{DoxyCompactList}\small\item\em Validates the chosen lineage is set up correctly. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_ab8a62d0ca2b1746676073e3f33e2a949}{check\+Sim\+Size} (unsigned long req\+\_\+data, unsigned long req\+\_\+active)
\begin{DoxyCompactList}\small\item\em Checks the size of the main active and data objects is large enough. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a95360a2f62ef0eb436d586552b299e1f}{write\+Sim\+Start\+To\+Console} ()\hypertarget{class_tree_a95360a2f62ef0eb436d586552b299e1f}{}\label{class_tree_a95360a2f62ef0eb436d586552b299e1f}

\begin{DoxyCompactList}\small\item\em Writes to the console that the simulation is beginning. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a1ba0f5d27c6ef6e9e17f988aff2dfe65}{set\+Sim\+Start\+Variables} ()
\begin{DoxyCompactList}\small\item\em Sets the variables at the start of a simulation for temporary data. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a01555697d3320e2cd9ee40f6747d5206}{check\+Map\+Update} ()\hypertarget{class_tree_a01555697d3320e2cd9ee40f6747d5206}{}\label{class_tree_a01555697d3320e2cd9ee40f6747d5206}

\begin{DoxyCompactList}\small\item\em Checks if the number of lineages should be expanded at another sample point. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a23803bddf46ad28a1bdd46bf05693b1f}{choose\+Random\+Lineage} ()
\begin{DoxyCompactList}\small\item\em Chooses a random lineage from active. \end{DoxyCompactList}\item 
bool \hyperlink{class_tree_afe75245862a1c40030c1c8607518cf8d}{run\+Simulation} ()
\begin{DoxyCompactList}\small\item\em Run the entire simulation given the start conditions already defined by \hyperlink{class_tree_aec10ea2b720edc13a38310afdfe2b6e4}{setup()} \end{DoxyCompactList}\item 
bool \hyperlink{class_tree_afd6bd75c301d2f57c4997fcfc92f192e}{stop\+Simulation} ()
\begin{DoxyCompactList}\small\item\em Finalises the simulation, and performs the correct tasks depending if the sim has been paused or finished. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_aea93074542f30a4a51c05140aae93708}{expand\+Map} (double generationin)
\begin{DoxyCompactList}\small\item\em Expands the map, generating the new lineages where necessary. \end{DoxyCompactList}\item 
unsigned long \hyperlink{class_tree_a2d2065bbebee8b55270d2691d40cd974}{sort\+Data} ()\hypertarget{class_tree_a2d2065bbebee8b55270d2691d40cd974}{}\label{class_tree_a2d2065bbebee8b55270d2691d40cd974}

\begin{DoxyCompactList}\small\item\em Sort and process the species list so that the useful information can be extracted from it. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_afdf680e187c25ed39d1e66542ce44cc3}{output\+Data} ()\hypertarget{class_tree_afdf680e187c25ed39d1e66542ce44cc3}{}\label{class_tree_afdf680e187c25ed39d1e66542ce44cc3}

\begin{DoxyCompactList}\small\item\em Outputs important simulation data to a csv file. Overloaded version which automatically calls \hyperlink{class_tree_a2d2065bbebee8b55270d2691d40cd974}{sort\+Data()} if no species richness is provided. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a5acf7d0eea9ea2ef4928bb6691b87724}{output\+Data} (unsigned long species\+\_\+richness)
\begin{DoxyCompactList}\small\item\em Outputs important simulation data to a csv file. This function will likely be remove in future versions as all simulation output is now contained in an S\+Q\+Lite database. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_ab8785fc9e27868a56335048321c13290}{write\+Times} ()\hypertarget{class_tree_ab8785fc9e27868a56335048321c13290}{}\label{class_tree_ab8785fc9e27868a56335048321c13290}

\begin{DoxyCompactList}\small\item\em Writes the times to the terminal for simulation information. \end{DoxyCompactList}\item 
virtual void \hyperlink{class_tree_a891764ffc1e29d3edbe0fd08e67a184b}{set\+Protracted\+Variables} (double speciation\+\_\+gen\+\_\+min, double speciation\+\_\+gen\+\_\+max)
\begin{DoxyCompactList}\small\item\em Sets the protracted variables. \end{DoxyCompactList}\item 
virtual string \hyperlink{class_tree_a34c0808026bf00546c8f9786376be730}{get\+Protracted\+Variables} ()
\begin{DoxyCompactList}\small\item\em Gets the protracted variables and returns them as a single, newline separated string. This method is intended to be overridden in derived classes. \end{DoxyCompactList}\item 
virtual double \hyperlink{class_tree_a6ffc42e941f352cd74f01f6f7011f00b}{get\+Protracted\+Generation\+Min} ()
\begin{DoxyCompactList}\small\item\em Gets the minimum number of generations a lineage must exist. \end{DoxyCompactList}\item 
virtual double \hyperlink{class_tree_a0c5e746982a87f24c083f4534bf92b45}{get\+Protracted\+Generation\+Max} ()
\begin{DoxyCompactList}\small\item\em Gets the maximum number of generations a lineage can exist. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_ae5308f74e982485ac444aa394b952152}{sim\+Pause} ()\hypertarget{class_tree_ae5308f74e982485ac444aa394b952152}{}\label{class_tree_ae5308f74e982485ac444aa394b952152}

\begin{DoxyCompactList}\small\item\em Pause the simulation and dump data from memory. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_ac545d844141db977920fc9fd76ce9dbb}{set\+Resume\+Parameters} (string pausedir, string outdir, unsigned long seed, unsigned long task, unsigned long new\+\_\+max\+\_\+time)
\begin{DoxyCompactList}\small\item\em Sets the resume variables so that the simulation can be resumed. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_aeade4bccb8394937a53bc4fbcf2b4300}{set\+Resume\+Parameters} ()\hypertarget{class_tree_aeade4bccb8394937a53bc4fbcf2b4300}{}\label{class_tree_aeade4bccb8394937a53bc4fbcf2b4300}

\begin{DoxyCompactList}\small\item\em Sets the resume variables to the defaults. \end{DoxyCompactList}\item 
virtual void \hyperlink{class_tree_af57075728924141c7b6d311822a22dc0}{load\+Main\+Save} ()\hypertarget{class_tree_af57075728924141c7b6d311822a22dc0}{}\label{class_tree_af57075728924141c7b6d311822a22dc0}

\begin{DoxyCompactList}\small\item\em Loads the main simulation parameters from the save file into memory. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_af7db53d4870d845741d3159f57b73b30}{load\+Data\+Save} ()\hypertarget{class_tree_af7db53d4870d845741d3159f57b73b30}{}\label{class_tree_af7db53d4870d845741d3159f57b73b30}

\begin{DoxyCompactList}\small\item\em Loads the data object from the save file into memory. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_af145148202f11654d6d6a15a6c021924}{load\+Active\+Save} ()\hypertarget{class_tree_af145148202f11654d6d6a15a6c021924}{}\label{class_tree_af145148202f11654d6d6a15a6c021924}

\begin{DoxyCompactList}\small\item\em Loads the active object from the save file into memory. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a2834ef82f447ca95c48310538c4b56ed}{load\+Grid\+Save} ()\hypertarget{class_tree_a2834ef82f447ca95c48310538c4b56ed}{}\label{class_tree_a2834ef82f447ca95c48310538c4b56ed}

\begin{DoxyCompactList}\small\item\em Loads the grid from the save file into memory. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a1d8d885f6db073e2b2fe8f58023f764f}{load\+Map\+Save} ()\hypertarget{class_tree_a1d8d885f6db073e2b2fe8f58023f764f}{}\label{class_tree_a1d8d885f6db073e2b2fe8f58023f764f}

\begin{DoxyCompactList}\small\item\em Loads the map from the save file into memory. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a3d614f3848dc7acab168642efe345569}{sim\+Resume} ()
\begin{DoxyCompactList}\small\item\em Resumes the simulation from a previous state. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_ae784a6ed362f6c5263ee797759f715b6}{sql\+Create} ()\hypertarget{class_tree_ae784a6ed362f6c5263ee797759f715b6}{}\label{class_tree_ae784a6ed362f6c5263ee797759f715b6}

\begin{DoxyCompactList}\small\item\em Generates the S\+QL database file from the full simulation data. This allows for greater analysis of the data after completion of the simulation. \end{DoxyCompactList}\item 
virtual string \hyperlink{class_tree_aa8bb5d93c7992404ede0a49bb69ccd1f}{protracted\+Vars\+To\+String} ()
\begin{DoxyCompactList}\small\item\em Outputs the protracted variables to a string. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a8cd3db7add1884ea53b0d98002d39cd3}{sql\+Output} ()
\begin{DoxyCompactList}\small\item\em Copy the in-\/memory database to file. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_ae0b48a12fd70982cc9dc2e31d7f4e84f}{apply\+Spec\+Rate} (double sr, double t)
\begin{DoxyCompactList}\small\item\em Applies the given speciation rate to the tree. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a789a2fc3bc53a99d120638fe009759ff}{apply\+Spec\+Rate} (double sr)
\begin{DoxyCompactList}\small\item\em Overloaded version of apply\+Spec\+Rates for the default generation (0.\+0). \end{DoxyCompactList}\item 
void \hyperlink{class_tree_acfc7efdec999f6dbf2ac089514d22091}{apply\+Multiple\+Rates} ()
\begin{DoxyCompactList}\small\item\em Applies multiple speciation rates to the coalescence tree, ignoring repeated speciation rates. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a25f082da13789dfa3fefcbcfd08b4dfe}{determine\+Speciation\+Rates} ()
\begin{DoxyCompactList}\small\item\em Determines the speciation rates to apply and then applies them to the coalescence tree post-\/simulation. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_ae07582bb85bff9bbb3f204c1066df9cc}{verify\+Reproduction\+Map} ()\hypertarget{class_tree_ae07582bb85bff9bbb3f204c1066df9cc}{}\label{class_tree_ae07582bb85bff9bbb3f204c1066df9cc}

\begin{DoxyCompactList}\small\item\em Checks that the reproduction map makes sense with the fine density map. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_acf089cdd22fee4b4621167baa1e17b4e}{add\+Wrapped\+Lineage} (unsigned long numstart, long x, long y)
\begin{DoxyCompactList}\small\item\em Adds the lineage to the correct point in the linked list of active lineages. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a6af2aaa691ffbb9899e3f070a715e371}{convert\+Tip} (unsigned long i, double generationin)
\begin{DoxyCompactList}\small\item\em Creates a new reference in data containing the tip with a new generation counter. \end{DoxyCompactList}\item 
unsigned long \hyperlink{class_tree_af49dbccf87142a9a2ba932cd7974246e}{count\+Cell\+Expansion} (const long \&x, const long \&y, const long \&xwrap, const long \&ywrap, const double \&generationin, const bool \&make\+\_\+tips)
\begin{DoxyCompactList}\small\item\em Counts the number of lineages at a particular location that need to be added, after making the correct number of those that already exist into tips. \end{DoxyCompactList}\item 
void \hyperlink{class_tree_a1ea4b59664591f312014ba15773176f1}{expand\+Cell} (long x, long y, long xwrap, long ywrap, double generationin, unsigned long add)
\begin{DoxyCompactList}\small\item\em Expands the cell at the desired location by adding the supplied number of lineages. \end{DoxyCompactList}\item 
void {\bfseries make\+Tip} (const unsigned long \&tmp\+\_\+active, const double \&generationin)\hypertarget{class_tree_a1ef4924887d8b9fdf3b45f35187d69d8}{}\label{class_tree_a1ef4924887d8b9fdf3b45f35187d69d8}

\item 
void \hyperlink{class_tree_a4918f354073488d7ace09fd80cd8991c}{validate\+Lineages} ()
\begin{DoxyCompactList}\small\item\em Validates all lineages have been set up correctly. This may take considerable time for larger simulations. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_row}{Row}$<$ \hyperlink{class_treenode}{Treenode} $>$ {\bfseries data}\hypertarget{class_tree_a59b96b790945010fda9b907df51038be}{}\label{class_tree_a59b96b790945010fda9b907df51038be}

\item 
unsigned long {\bfseries enddata}\hypertarget{class_tree_a50344999e6b64d15eef935b1f6023471}{}\label{class_tree_a50344999e6b64d15eef935b1f6023471}

\item 
\hyperlink{struct_sim_parameters}{Sim\+Parameters} {\bfseries sim\+\_\+parameters}\hypertarget{class_tree_a63c399793a209332ad0f5da7fc830d56}{}\label{class_tree_a63c399793a209332ad0f5da7fc830d56}

\item 
\hyperlink{class_n_rrand}{N\+Rrand} {\bfseries NR}\hypertarget{class_tree_aa7df162306777b040a9a2aac543e6801}{}\label{class_tree_aa7df162306777b040a9a2aac543e6801}

\item 
\hyperlink{class_dispersal_coordinator}{Dispersal\+Coordinator} {\bfseries dispersal\+\_\+coordinator}\hypertarget{class_tree_afbf25a881b31ea6558bb9dc48c431a73}{}\label{class_tree_afbf25a881b31ea6558bb9dc48c431a73}

\item 
\hyperlink{class_reproduction_map}{Reproduction\+Map} {\bfseries rep\+\_\+map}\hypertarget{class_tree_a7a85301c230febe654c002695828c9a9}{}\label{class_tree_a7a85301c230febe654c002695828c9a9}

\item 
vector$<$ double $>$ {\bfseries speciation\+\_\+rates}\hypertarget{class_tree_a702ccb094de94922b77548d50f025c8f}{}\label{class_tree_a702ccb094de94922b77548d50f025c8f}

\item 
bool {\bfseries seeded}\hypertarget{class_tree_a78935befd45946b8e69023bffca59c1d}{}\label{class_tree_a78935befd45946b8e69023bffca59c1d}

\item 
long long {\bfseries the\+\_\+seed}\hypertarget{class_tree_acf483ed0a44629c9aa4690a08017ee35}{}\label{class_tree_acf483ed0a44629c9aa4690a08017ee35}

\item 
bool {\bfseries log\+\_\+all}\hypertarget{class_tree_aada408975aa28b8992e98709d6c376fb}{}\label{class_tree_aada408975aa28b8992e98709d6c376fb}

\item 
long long {\bfseries the\+\_\+task}\hypertarget{class_tree_a9f74137d5c9c5529ec9a06f88dfa6960}{}\label{class_tree_a9f74137d5c9c5529ec9a06f88dfa6960}

\item 
string {\bfseries autocorrel\+\_\+file}\hypertarget{class_tree_a4713ae4a4068fa911bc346b594bbade6}{}\label{class_tree_a4713ae4a4068fa911bc346b594bbade6}

\item 
vector$<$ double $>$ {\bfseries autocorrel\+\_\+times}\hypertarget{class_tree_acbf9101bb6c28d5a0f174801c27c23b6}{}\label{class_tree_acbf9101bb6c28d5a0f174801c27c23b6}

\item 
bool {\bfseries b\+Autocorrel}\hypertarget{class_tree_aa4e3e77ce6b3fdbab72270144e63345a}{}\label{class_tree_aa4e3e77ce6b3fdbab72270144e63345a}

\item 
string {\bfseries finemapinput}\hypertarget{class_tree_a87e08c5f970f699a1d4c2a4abb00eb4e}{}\label{class_tree_a87e08c5f970f699a1d4c2a4abb00eb4e}

\item 
string {\bfseries coarsemapinput}\hypertarget{class_tree_af5e636fe4eb845d4c7b1a8a15e837c82}{}\label{class_tree_af5e636fe4eb845d4c7b1a8a15e837c82}

\item 
string {\bfseries outdirectory}\hypertarget{class_tree_a70b8a86ec0b71a04b4a26061bcaeb4a3}{}\label{class_tree_a70b8a86ec0b71a04b4a26061bcaeb4a3}

\item 
string {\bfseries pause\+\_\+sim\+\_\+directory}\hypertarget{class_tree_a504a4d7ae23146fd6236baa59da51a6e}{}\label{class_tree_a504a4d7ae23146fd6236baa59da51a6e}

\item 
string {\bfseries pristinefinemapinput}\hypertarget{class_tree_a3ef73c700c06c9ebab564cc9ec9fc4ab}{}\label{class_tree_a3ef73c700c06c9ebab564cc9ec9fc4ab}

\item 
string {\bfseries pristinecoarsemapinput}\hypertarget{class_tree_aab9168e35202fe02d4ef82087530a3bf}{}\label{class_tree_aab9168e35202fe02d4ef82087530a3bf}

\item 
double {\bfseries d\+Pristine}\hypertarget{class_tree_a893f37cf3b242be781aae29843a584ee}{}\label{class_tree_a893f37cf3b242be781aae29843a584ee}

\item 
double {\bfseries d\+Forest\+Transform}\hypertarget{class_tree_ae9e9a7c06a049531e8a4dd1319cff1b8}{}\label{class_tree_ae9e9a7c06a049531e8a4dd1319cff1b8}

\item 
unsigned long {\bfseries gridxsize}\hypertarget{class_tree_af58ab9dcfed2cbfa93cf47c68c90e0c4}{}\label{class_tree_af58ab9dcfed2cbfa93cf47c68c90e0c4}

\item 
unsigned long {\bfseries gridysize}\hypertarget{class_tree_a458b504f61e3c642ef5223048799b7ba}{}\label{class_tree_a458b504f61e3c642ef5223048799b7ba}

\item 
long {\bfseries finemapxsize}\hypertarget{class_tree_a4790f4c0210c285b7728599ea2faa98f}{}\label{class_tree_a4790f4c0210c285b7728599ea2faa98f}

\item 
long {\bfseries finemapysize}\hypertarget{class_tree_a2424883553f76a36447fee4de06f779d}{}\label{class_tree_a2424883553f76a36447fee4de06f779d}

\item 
long {\bfseries finemapxoffset}\hypertarget{class_tree_a266216111e7116fbaaa7fd10134a50c3}{}\label{class_tree_a266216111e7116fbaaa7fd10134a50c3}

\item 
long {\bfseries finemapyoffset}\hypertarget{class_tree_a53790cb843a74543acc4bfd536f815e8}{}\label{class_tree_a53790cb843a74543acc4bfd536f815e8}

\item 
long {\bfseries coarsemapxsize}\hypertarget{class_tree_a857af46452e877120b61ce7d1a111b9b}{}\label{class_tree_a857af46452e877120b61ce7d1a111b9b}

\item 
long {\bfseries coarsemapysize}\hypertarget{class_tree_a5ac36f0d1a8b951dad10ca3de8334543}{}\label{class_tree_a5ac36f0d1a8b951dad10ca3de8334543}

\item 
long {\bfseries coarsemapxoffset}\hypertarget{class_tree_a67cf6b6ce0b683ce4b6014bf1df575fe}{}\label{class_tree_a67cf6b6ce0b683ce4b6014bf1df575fe}

\item 
long {\bfseries coarsemapyoffset}\hypertarget{class_tree_a29b4b790dcb14d5306df0448a53ac2ee}{}\label{class_tree_a29b4b790dcb14d5306df0448a53ac2ee}

\item 
long {\bfseries coarsemapscale}\hypertarget{class_tree_a24fb21a6a22d727acae9dd4cd946adb3}{}\label{class_tree_a24fb21a6a22d727acae9dd4cd946adb3}

\item 
bool {\bfseries varimport}\hypertarget{class_tree_a96f63bbb23ebc547d2b91c30e4ce1f57}{}\label{class_tree_a96f63bbb23ebc547d2b91c30e4ce1f57}

\item 
time\+\_\+t {\bfseries start}\hypertarget{class_tree_ac077d686ee96b123aa779e8a8a5de3ce}{}\label{class_tree_ac077d686ee96b123aa779e8a8a5de3ce}

\item 
time\+\_\+t {\bfseries sim\+\_\+start}\hypertarget{class_tree_a01cc9b30f2b10b9f51b218df25b13b09}{}\label{class_tree_a01cc9b30f2b10b9f51b218df25b13b09}

\item 
time\+\_\+t {\bfseries sim\+\_\+end}\hypertarget{class_tree_a26100477c7e58a9e0a90cdee1379ed69}{}\label{class_tree_a26100477c7e58a9e0a90cdee1379ed69}

\item 
time\+\_\+t {\bfseries now}\hypertarget{class_tree_a5510d0fb5deb23fd39a2619d104f85fa}{}\label{class_tree_a5510d0fb5deb23fd39a2619d104f85fa}

\item 
time\+\_\+t {\bfseries sim\+\_\+finish}\hypertarget{class_tree_ac399ba59be9dc33a04223d10a82ee5ee}{}\label{class_tree_ac399ba59be9dc33a04223d10a82ee5ee}

\item 
time\+\_\+t {\bfseries out\+\_\+finish}\hypertarget{class_tree_a5ee1fa5adf72bb599badc041fbee7d09}{}\label{class_tree_a5ee1fa5adf72bb599badc041fbee7d09}

\item 
time\+\_\+t {\bfseries time\+\_\+taken}\hypertarget{class_tree_abd18bb487c0192588b6bed6f00bcfd07}{}\label{class_tree_abd18bb487c0192588b6bed6f00bcfd07}

\item 
\hyperlink{class_map}{Map} {\bfseries forestmap}\hypertarget{class_tree_af412a7888f61b9f9931e33485562aa03}{}\label{class_tree_af412a7888f61b9f9931e33485562aa03}

\item 
\hyperlink{class_matrix}{Matrix}$<$ \hyperlink{class_species_list}{Species\+List} $>$ {\bfseries grid}\hypertarget{class_tree_a1962e04a61c54545862b47943a7cf576}{}\label{class_tree_a1962e04a61c54545862b47943a7cf576}

\item 
\hyperlink{class_row}{Row}$<$ \hyperlink{class_datapoint}{Datapoint} $>$ {\bfseries active}\hypertarget{class_tree_a2c42ce89a7d6556be51254b5b09c27e3}{}\label{class_tree_a2c42ce89a7d6556be51254b5b09c27e3}

\item 
unsigned long {\bfseries endactive}\hypertarget{class_tree_ab478831f09c135bc9a4bc991c9fd5076}{}\label{class_tree_ab478831f09c135bc9a4bc991c9fd5076}

\item 
unsigned long {\bfseries startendactive}\hypertarget{class_tree_a3f1a90ab7ef917a996790e5ddfcebf85}{}\label{class_tree_a3f1a90ab7ef917a996790e5ddfcebf85}

\item 
unsigned long {\bfseries maxsimsize}\hypertarget{class_tree_a0244ee15452c38393246147d93836b4d}{}\label{class_tree_a0244ee15452c38393246147d93836b4d}

\item 
long {\bfseries steps}\hypertarget{class_tree_ae7d33b8c16eeb8cb0c7f96dbfbc61b4e}{}\label{class_tree_ae7d33b8c16eeb8cb0c7f96dbfbc61b4e}

\item 
unsigned long {\bfseries maxtime}\hypertarget{class_tree_a1868cf626a0b12f21a038989d4eca210}{}\label{class_tree_a1868cf626a0b12f21a038989d4eca210}

\item 
double {\bfseries generation}\hypertarget{class_tree_a84cc46d51045ff3b161ee8788950e0c2}{}\label{class_tree_a84cc46d51045ff3b161ee8788950e0c2}

\item 
double {\bfseries sigma}\hypertarget{class_tree_aa030e8074eb9d60b4a00321b3980352e}{}\label{class_tree_aa030e8074eb9d60b4a00321b3980352e}

\item 
double {\bfseries tau}\hypertarget{class_tree_a35a960e7950aa879f06e456651b44999}{}\label{class_tree_a35a960e7950aa879f06e456651b44999}

\item 
double {\bfseries deme\+\_\+sample}\hypertarget{class_tree_ac7a1d0583d3dcb55c50fec0e1fd57985}{}\label{class_tree_ac7a1d0583d3dcb55c50fec0e1fd57985}

\item 
long double {\bfseries spec}\hypertarget{class_tree_a586678f7084086add3a4136476abd375}{}\label{class_tree_a586678f7084086add3a4136476abd375}

\item 
double {\bfseries dispersal\+\_\+relative\+\_\+cost}\hypertarget{class_tree_af2532e98184a5b0ce0d289e4f264d98f}{}\label{class_tree_af2532e98184a5b0ce0d289e4f264d98f}

\item 
long {\bfseries deme}\hypertarget{class_tree_a9fe104115b4593c772c03b57b82ff0de}{}\label{class_tree_a9fe104115b4593c772c03b57b82ff0de}

\item 
unsigned long {\bfseries desired\+\_\+specnum}\hypertarget{class_tree_a2d6aec268fc1c842e0f94dfd8b7f97f8}{}\label{class_tree_a2d6aec268fc1c842e0f94dfd8b7f97f8}

\item 
sqlite3 $\ast$ {\bfseries database}\hypertarget{class_tree_aae24ce11e30fbd74fe078b23b46c14cd}{}\label{class_tree_aae24ce11e30fbd74fe078b23b46c14cd}

\item 
sqlite3 $\ast$ {\bfseries outdatabase}\hypertarget{class_tree_afd585c8a4bdb86461780418f7b886abd}{}\label{class_tree_afd585c8a4bdb86461780418f7b886abd}

\item 
string {\bfseries sqloutname}\hypertarget{class_tree_ade2744c2510a6e8ae791ca7189f483bb}{}\label{class_tree_ade2744c2510a6e8ae791ca7189f483bb}

\item 
\hyperlink{class_treelist}{Treelist} {\bfseries tl}\hypertarget{class_tree_a53cf3dfb83813f6148f44e767b2f627d}{}\label{class_tree_a53cf3dfb83813f6148f44e767b2f627d}

\item 
\hyperlink{class_datamask}{Datamask} {\bfseries samplegrid}\hypertarget{class_tree_a00a26fffe55a8399efff0ca3b42a46aa}{}\label{class_tree_a00a26fffe55a8399efff0ca3b42a46aa}

\item 
bool {\bfseries sim\+\_\+complete}\hypertarget{class_tree_a07f9982fd6f6243c78ef42371603bbe4}{}\label{class_tree_a07f9982fd6f6243c78ef42371603bbe4}

\item 
\hyperlink{struct_step}{Step} {\bfseries this\+\_\+step}\hypertarget{class_tree_af7de4d4f04360edcbe2a20db882b1f87}{}\label{class_tree_af7de4d4f04360edcbe2a20db882b1f87}

\item 
bool {\bfseries b\+Fullmode}\hypertarget{class_tree_a9379466b9fc0f25bd28543743000e700}{}\label{class_tree_a9379466b9fc0f25bd28543743000e700}

\item 
bool {\bfseries b\+Resume}\hypertarget{class_tree_ac9cbd7d17fb511c1fcc70c765f6440b0}{}\label{class_tree_ac9cbd7d17fb511c1fcc70c765f6440b0}

\item 
bool {\bfseries b\+Config}\hypertarget{class_tree_a6c8c76aec6a9faef9c38f4f275b0793d}{}\label{class_tree_a6c8c76aec6a9faef9c38f4f275b0793d}

\item 
bool {\bfseries b\+Paused}\hypertarget{class_tree_a8d219fd6e324aa3932022017bac93d09}{}\label{class_tree_a8d219fd6e324aa3932022017bac93d09}

\item 
bool {\bfseries b\+Paused\+Import}\hypertarget{class_tree_aed328cb90b338065ec5a391a46e5bad2}{}\label{class_tree_aed328cb90b338065ec5a391a46e5bad2}

\item 
bool {\bfseries b\+Is\+Protracted}\hypertarget{class_tree_a1f7515f16d99a9748ab2c4c667f1ffc4}{}\label{class_tree_a1f7515f16d99a9748ab2c4c667f1ffc4}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
Represents the output phylogenetic tree. 

Contains all functions for running simulations, outputting data and calculating coalescence tree structure. This could be useful for H\+PC simulations or integration into a G\+UI. 

\subsection{Constructor \& Destructor Documentation}
\index{CoalescenceTree@{CoalescenceTree}!CoalescenceTree@{CoalescenceTree}}
\index{CoalescenceTree@{CoalescenceTree}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{CoalescenceTree()}{CoalescenceTree()}}]{\setlength{\rightskip}{0pt plus 5cm}CoalescenceTree\+::\+CoalescenceTree (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{class_tree_ad376a7c639d857312f5de2ef47482f68}{}\label{class_tree_ad376a7c639d857312f5de2ef47482f68}


The constructor for the tree object. 

Sets all uninitiated variables to false, except log\+\_\+all. log\+\_\+all should be changed to false if minimal text output during simulations is desired. 

\subsection{Member Function Documentation}
\index{CoalescenceTree@{CoalescenceTree}!add\+Wrapped\+Lineage@{add\+Wrapped\+Lineage}}
\index{add\+Wrapped\+Lineage@{add\+Wrapped\+Lineage}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{add\+Wrapped\+Lineage(unsigned long numstart, long x, long y)}{addWrappedLineage(unsigned long numstart, long x, long y)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::add\+Wrapped\+Lineage (
\begin{DoxyParamCaption}
\item[{unsigned long}]{numstart, }
\item[{long}]{x, }
\item[{long}]{y}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_acf089cdd22fee4b4621167baa1e17b4e}{}\label{class_tree_acf089cdd22fee4b4621167baa1e17b4e}


Adds the lineage to the correct point in the linked list of active lineages. 


\begin{DoxyParams}{Parameters}
{\em numstart} & the active position to add \\
\hline
{\em x} & the x position of the lineage \\
\hline
{\em y} & the y position of the lineage \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!apply\+Multiple\+Rates@{apply\+Multiple\+Rates}}
\index{apply\+Multiple\+Rates@{apply\+Multiple\+Rates}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{apply\+Multiple\+Rates()}{applyMultipleRates()}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::apply\+Multiple\+Rates (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_acfc7efdec999f6dbf2ac089514d22091}{}\label{class_tree_acfc7efdec999f6dbf2ac089514d22091}


Applies multiple speciation rates to the coalescence tree, ignoring repeated speciation rates. 

Speciation rates are read from the speciation\+\_\+rates object, which should have already been calculated. \index{CoalescenceTree@{CoalescenceTree}!apply\+Spec\+Rate@{apply\+Spec\+Rate}}
\index{apply\+Spec\+Rate@{apply\+Spec\+Rate}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{apply\+Spec\+Rate(double sr, double t)}{applySpecRate(double sr, double t)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::apply\+Spec\+Rate (
\begin{DoxyParamCaption}
\item[{double}]{sr, }
\item[{double}]{t}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_ae0b48a12fd70982cc9dc2e31d7f4e84f}{}\label{class_tree_ae0b48a12fd70982cc9dc2e31d7f4e84f}


Applies the given speciation rate to the tree. 


\begin{DoxyParams}{Parameters}
{\em sr} & the required speciation rate \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!apply\+Spec\+Rate@{apply\+Spec\+Rate}}
\index{apply\+Spec\+Rate@{apply\+Spec\+Rate}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{apply\+Spec\+Rate(double sr)}{applySpecRate(double sr)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::apply\+Spec\+Rate (
\begin{DoxyParamCaption}
\item[{double}]{sr}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a789a2fc3bc53a99d120638fe009759ff}{}\label{class_tree_a789a2fc3bc53a99d120638fe009759ff}


Overloaded version of apply\+Spec\+Rates for the default generation (0.\+0). 


\begin{DoxyParams}{Parameters}
{\em sr} & the speciation rate to apply to the tree \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!calc\+Min\+Max@{calc\+Min\+Max}}
\index{calc\+Min\+Max@{calc\+Min\+Max}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{calc\+Min\+Max(const unsigned long \&current)}{calcMinMax(const unsigned long &current)}}]{\setlength{\rightskip}{0pt plus 5cm}long double CoalescenceTree\+::calc\+Min\+Max (
\begin{DoxyParamCaption}
\item[{const unsigned long \&}]{current}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a70a652ff4273d83e642257e4f5b5dd47}{}\label{class_tree_a70a652ff4273d83e642257e4f5b5dd47}


Calculates the minmax for a given branch. 

Calculates the speciation rate required for speciation to have occured on this branch.


\begin{DoxyParams}{Parameters}
{\em current} & the current active reference to perform calculations over. \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!calc\+Move@{calc\+Move}}
\index{calc\+Move@{calc\+Move}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{calc\+Move(\+Step \&this\+\_\+step)}{calcMove(Step &this_step)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::calc\+Move (
\begin{DoxyParamCaption}
\item[{{\bf Step} \&}]{this\+\_\+step}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_afeb039e194f964582905951f510b096c}{}\label{class_tree_afeb039e194f964582905951f510b096c}


Calculate the move, given a start x,y coordinates and wrapping. 

The provided parameters will be altered to contain the new values so no record of the old variables remains after function running. Current dispersal methods use a fattailed dispersal.


\begin{DoxyParams}{Parameters}
{\em this\+\_\+step} & the \hyperlink{struct_step}{Step} object containing coordinates and distances for this step \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!calc\+New\+Pos@{calc\+New\+Pos}}
\index{calc\+New\+Pos@{calc\+New\+Pos}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{calc\+New\+Pos(bool \&coal, const unsigned long \&chosen, unsigned long \&coalchosen, const long \&oldx, const long \&oldy, const long \&oldxwrap, const long \&oldywrap)}{calcNewPos(bool &coal, const unsigned long &chosen, unsigned long &coalchosen, const long &oldx, const long &oldy, const long &oldxwrap, const long &oldywrap)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::calc\+New\+Pos (
\begin{DoxyParamCaption}
\item[{bool \&}]{coal, }
\item[{const unsigned long \&}]{chosen, }
\item[{unsigned long \&}]{coalchosen, }
\item[{const long \&}]{oldx, }
\item[{const long \&}]{oldy, }
\item[{const long \&}]{oldxwrap, }
\item[{const long \&}]{oldywrap}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a05a0e0f5f70d2763f9dad3bd54618c62}{}\label{class_tree_a05a0e0f5f70d2763f9dad3bd54618c62}


Calculates the new position, checking whether coalescence has occured and with which lineage. 

This involves correct handling of checking wrapped lineages (outside the original grid). The probability of coalescence is also calculated.


\begin{DoxyParams}{Parameters}
{\em coal} & boolean for whether coalescence occured or not \\
\hline
{\em chosen} & the chosen lineage \\
\hline
{\em coalchosen} & the lineaged that is coalescing (if required) \\
\hline
{\em oldx} & the old x position \\
\hline
{\em oldy} & the old y position \\
\hline
{\em oldxwrap} & the old x wrapping \\
\hline
{\em oldywrap} & the old y wrapping \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!calc\+Speciation@{calc\+Speciation}}
\index{calc\+Speciation@{calc\+Speciation}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{calc\+Speciation(const long double \&random\+\_\+number, const long double \&speciation\+\_\+rate, const int \&no\+\_\+generations)}{calcSpeciation(const long double &random_number, const long double &speciation_rate, const int &no_generations)}}]{\setlength{\rightskip}{0pt plus 5cm}bool CoalescenceTree\+::calc\+Speciation (
\begin{DoxyParamCaption}
\item[{const long double \&}]{random\+\_\+number, }
\item[{const long double \&}]{speciation\+\_\+rate, }
\item[{const int \&}]{no\+\_\+generations}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{class_tree_a0a6fd214c1e4b77955add6ffa9f76d5d}{}\label{class_tree_a0a6fd214c1e4b77955add6ffa9f76d5d}


Calculates the speciation probability from the random number, speciation rate and number of generations a lineage has existed for. 


\begin{DoxyParams}{Parameters}
{\em random\+\_\+number} & the generated random number from 0-\/1 \\
\hline
{\em speciation\+\_\+rate} & the speciation rate to be applied \\
\hline
{\em no\+\_\+generations} & the number of generations a lineage has existed for \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
if true, speciation has occured 
\end{DoxyReturn}


Reimplemented in \hyperlink{class_protracted_tree_ad4a23e4ddf54b374c6620f23f18cff27}{Protracted\+CoalescenceTree}.

\index{CoalescenceTree@{CoalescenceTree}!check\+Sims@{check\+Sims}}
\index{check\+Sims@{check\+Sims}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{check\+Sims()}{checkSims()}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::check\+Sims (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_ad0bcc474a9ab1d4e3e2458c4de7304ad}{}\label{class_tree_ad0bcc474a9ab1d4e3e2458c4de7304ad}


Checks for existing paused simulations to resume from Sets b\+Paused if there are. 

This version uses the default values read from the config file. \index{CoalescenceTree@{CoalescenceTree}!check\+Sims@{check\+Sims}}
\index{check\+Sims@{check\+Sims}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{check\+Sims(string output\+\_\+dir, long seed, long task)}{checkSims(string output_dir, long seed, long task)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::check\+Sims (
\begin{DoxyParamCaption}
\item[{string}]{output\+\_\+dir, }
\item[{long}]{seed, }
\item[{long}]{task}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_aafaede1da6c79583bf2e28b7a1881a5c}{}\label{class_tree_aafaede1da6c79583bf2e28b7a1881a5c}


Checks for existing paused simulations to resume from. 

Sets b\+Paused if there are.

This version uses the values supplied to the function directly


\begin{DoxyParams}{Parameters}
{\em output\+\_\+dir} & the output directory to check for \\
\hline
{\em seed} & the seed for paused sims \\
\hline
{\em task} & the task for paused sims \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!check\+Sim\+Size@{check\+Sim\+Size}}
\index{check\+Sim\+Size@{check\+Sim\+Size}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{check\+Sim\+Size(unsigned long req\+\_\+data, unsigned long req\+\_\+active)}{checkSimSize(unsigned long req_data, unsigned long req_active)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::check\+Sim\+Size (
\begin{DoxyParamCaption}
\item[{unsigned long}]{req\+\_\+data, }
\item[{unsigned long}]{req\+\_\+active}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_ab8a62d0ca2b1746676073e3f33e2a949}{}\label{class_tree_ab8a62d0ca2b1746676073e3f33e2a949}


Checks the size of the main active and data objects is large enough. 


\begin{DoxyParams}{Parameters}
{\em req\+\_\+data} & the required data object size \\
\hline
{\em req\+\_\+active} & the required active object size \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!choose\+Random\+Lineage@{choose\+Random\+Lineage}}
\index{choose\+Random\+Lineage@{choose\+Random\+Lineage}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{choose\+Random\+Lineage()}{chooseRandomLineage()}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::choose\+Random\+Lineage (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a23803bddf46ad28a1bdd46bf05693b1f}{}\label{class_tree_a23803bddf46ad28a1bdd46bf05693b1f}


Chooses a random lineage from active. 

The index of the random lineage is stored in this\+\_\+step, as chosen. Also records the required variables for the step process, like x, y position. \index{CoalescenceTree@{CoalescenceTree}!coalescence\+Event@{coalescence\+Event}}
\index{coalescence\+Event@{coalescence\+Event}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{coalescence\+Event(const unsigned long \&chosen, unsigned long \&coalchosen)}{coalescenceEvent(const unsigned long &chosen, unsigned long &coalchosen)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::coalescence\+Event (
\begin{DoxyParamCaption}
\item[{const unsigned long \&}]{chosen, }
\item[{unsigned long \&}]{coalchosen}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a16eedb70009e7570d933f88e8ce44117}{}\label{class_tree_a16eedb70009e7570d933f88e8ce44117}


Perform the coalescence between lineages. Once coalesced, lineages are removed from the active scope. 


\begin{DoxyParams}{Parameters}
{\em chosen} & the chosen lineage for coalescence \\
\hline
{\em coalchosen} & the target lineage for coalscence \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!convert\+Tip@{convert\+Tip}}
\index{convert\+Tip@{convert\+Tip}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{convert\+Tip(unsigned long i, double generationin)}{convertTip(unsigned long i, double generationin)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::convert\+Tip (
\begin{DoxyParamCaption}
\item[{unsigned long}]{i, }
\item[{double}]{generationin}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a6af2aaa691ffbb9899e3f070a715e371}{}\label{class_tree_a6af2aaa691ffbb9899e3f070a715e371}


Creates a new reference in data containing the tip with a new generation counter. 


\begin{DoxyParams}{Parameters}
{\em i} & the reference in active of the lineage to make a tip \\
\hline
{\em generationin} & the generation to make the lineage a tip at \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!count\+Cell\+Expansion@{count\+Cell\+Expansion}}
\index{count\+Cell\+Expansion@{count\+Cell\+Expansion}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{count\+Cell\+Expansion(const long \&x, const long \&y, const long \&xwrap, const long \&ywrap, const double \&generationin, const bool \&make\+\_\+tips)}{countCellExpansion(const long &x, const long &y, const long &xwrap, const long &ywrap, const double &generationin, const bool &make_tips)}}]{\setlength{\rightskip}{0pt plus 5cm}unsigned long CoalescenceTree\+::count\+Cell\+Expansion (
\begin{DoxyParamCaption}
\item[{const long \&}]{x, }
\item[{const long \&}]{y, }
\item[{const long \&}]{xwrap, }
\item[{const long \&}]{ywrap, }
\item[{const double \&}]{generationin, }
\item[{const bool \&}]{make\+\_\+tips}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_af49dbccf87142a9a2ba932cd7974246e}{}\label{class_tree_af49dbccf87142a9a2ba932cd7974246e}


Counts the number of lineages at a particular location that need to be added, after making the correct number of those that already exist into tips. 


\begin{DoxyParams}{Parameters}
{\em x} & the x coordinate of the location of interest \\
\hline
{\em y} & the y coordinate of the location of interest \\
\hline
{\em xwrap} & the x wrapping of the location \\
\hline
{\em ywrap} & the y wrapping of the location \\
\hline
{\em generationin} & the generation to assign to new tips \\
\hline
{\em make\+\_\+tips} & if true, stores the tips as well as counting them \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the number of new lineages that need to be added. 
\end{DoxyReturn}
\index{CoalescenceTree@{CoalescenceTree}!determine\+Speciation\+Rates@{determine\+Speciation\+Rates}}
\index{determine\+Speciation\+Rates@{determine\+Speciation\+Rates}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{determine\+Speciation\+Rates()}{determineSpeciationRates()}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::determine\+Speciation\+Rates (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a25f082da13789dfa3fefcbcfd08b4dfe}{}\label{class_tree_a25f082da13789dfa3fefcbcfd08b4dfe}


Determines the speciation rates to apply and then applies them to the coalescence tree post-\/simulation. 

Detects speciation rates from the config files supplied. \index{CoalescenceTree@{CoalescenceTree}!est\+Specnum@{est\+Specnum}}
\index{est\+Specnum@{est\+Specnum}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{est\+Specnum()}{estSpecnum()}}]{\setlength{\rightskip}{0pt plus 5cm}unsigned long CoalescenceTree\+::est\+Specnum (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a8f4c4cbc5ad516f0fde489c9a826e676}{}\label{class_tree_a8f4c4cbc5ad516f0fde489c9a826e676}


Estimates the species number from the second largest minimum speciation rate remaining in active. 

This allows for halting of the simulation once this threshold has been reached. However, the function is not currently in use as calculating the coalescence tree is very computionally intensive. \begin{DoxyRefDesc}{Deprecated}
\item[\hyperlink{deprecated__deprecated000006}{Deprecated}]this function is currently obselete and not implemented, but was still functional as of version 3.\+2\end{DoxyRefDesc}
\index{CoalescenceTree@{CoalescenceTree}!expand\+Cell@{expand\+Cell}}
\index{expand\+Cell@{expand\+Cell}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{expand\+Cell(long x, long y, long xwrap, long ywrap, double generationin, unsigned long add)}{expandCell(long x, long y, long xwrap, long ywrap, double generationin, unsigned long add)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::expand\+Cell (
\begin{DoxyParamCaption}
\item[{long}]{x, }
\item[{long}]{y, }
\item[{long}]{xwrap, }
\item[{long}]{ywrap, }
\item[{double}]{generationin, }
\item[{unsigned long}]{add}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a1ea4b59664591f312014ba15773176f1}{}\label{class_tree_a1ea4b59664591f312014ba15773176f1}


Expands the cell at the desired location by adding the supplied number of lineages. 

This takes into account wrapping to correctly add the right number


\begin{DoxyParams}{Parameters}
{\em x} & the x coordinate to add at \\
\hline
{\em y} & the y coordinate to add at \\
\hline
{\em xwrap} & the x wrapping to add at \\
\hline
{\em ywrap} & the y wrapping to add at \\
\hline
{\em generationin} & the generation to set the new lineages to \\
\hline
{\em add} & the total number of lineages to add at this location \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!expand\+Map@{expand\+Map}}
\index{expand\+Map@{expand\+Map}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{expand\+Map(double generationin)}{expandMap(double generationin)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::expand\+Map (
\begin{DoxyParamCaption}
\item[{double}]{generationin}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_aea93074542f30a4a51c05140aae93708}{}\label{class_tree_aea93074542f30a4a51c05140aae93708}


Expands the map, generating the new lineages where necessary. 

The samplemask provided is used for expansion. Any empty spaces are filled with a new lineage. Lineages which have not moved are changed to tips, with a new data entry so that original and new generations are recorded.


\begin{DoxyParams}{Parameters}
{\em generationin} & the generation that the expansion is occuring at. This is used in recording the new tips \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!getb\+Paused@{getb\+Paused}}
\index{getb\+Paused@{getb\+Paused}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{getb\+Paused()}{getbPaused()}}]{\setlength{\rightskip}{0pt plus 5cm}bool CoalescenceTree\+::getb\+Paused (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a839ff291e97962d1aaed4d785f394a89}{}\label{class_tree_a839ff291e97962d1aaed4d785f394a89}


Gets the b\+Paused variable for resuming sims. 

\begin{DoxyReturn}{Returns}
b\+Paused 
\end{DoxyReturn}
\index{CoalescenceTree@{CoalescenceTree}!get\+Protracted\+Generation\+Max@{get\+Protracted\+Generation\+Max}}
\index{get\+Protracted\+Generation\+Max@{get\+Protracted\+Generation\+Max}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{get\+Protracted\+Generation\+Max()}{getProtractedGenerationMax()}}]{\setlength{\rightskip}{0pt plus 5cm}double CoalescenceTree\+::get\+Protracted\+Generation\+Max (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{class_tree_a0c5e746982a87f24c083f4534bf92b45}{}\label{class_tree_a0c5e746982a87f24c083f4534bf92b45}


Gets the maximum number of generations a lineage can exist. 

Without overriding this function, should always return 0.\+0 (no maximum).

\begin{DoxyReturn}{Returns}
double the number of generations a lineage must exist 
\end{DoxyReturn}


Reimplemented in \hyperlink{class_protracted_tree_a705f8141d382c336d5b237d446cbe945}{Protracted\+CoalescenceTree}.

\index{CoalescenceTree@{CoalescenceTree}!get\+Protracted\+Generation\+Min@{get\+Protracted\+Generation\+Min}}
\index{get\+Protracted\+Generation\+Min@{get\+Protracted\+Generation\+Min}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{get\+Protracted\+Generation\+Min()}{getProtractedGenerationMin()}}]{\setlength{\rightskip}{0pt plus 5cm}double CoalescenceTree\+::get\+Protracted\+Generation\+Min (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{class_tree_a6ffc42e941f352cd74f01f6f7011f00b}{}\label{class_tree_a6ffc42e941f352cd74f01f6f7011f00b}


Gets the minimum number of generations a lineage must exist. 

Without overriding this function, should always return 0.\+0. \begin{DoxyReturn}{Returns}
double the number of generations a lineage must exist 
\end{DoxyReturn}


Reimplemented in \hyperlink{class_protracted_tree_a93f2dc40d4539703e56282f5aacd0e23}{Protracted\+CoalescenceTree}.

\index{CoalescenceTree@{CoalescenceTree}!get\+Protracted\+Variables@{get\+Protracted\+Variables}}
\index{get\+Protracted\+Variables@{get\+Protracted\+Variables}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{get\+Protracted\+Variables()}{getProtractedVariables()}}]{\setlength{\rightskip}{0pt plus 5cm}string CoalescenceTree\+::get\+Protracted\+Variables (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{class_tree_a34c0808026bf00546c8f9786376be730}{}\label{class_tree_a34c0808026bf00546c8f9786376be730}


Gets the protracted variables and returns them as a single, newline separated string. This method is intended to be overridden in derived classes. 

\begin{DoxyReturn}{Returns}
string containing the protracted variables, separated by newlines. 
\end{DoxyReturn}


Reimplemented in \hyperlink{class_protracted_tree_a5558d12d0595e3789a317c9eb9d88f5f}{Protracted\+CoalescenceTree}.

\index{CoalescenceTree@{CoalescenceTree}!get\+Seed@{get\+Seed}}
\index{get\+Seed@{get\+Seed}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{get\+Seed()}{getSeed()}}]{\setlength{\rightskip}{0pt plus 5cm}long long CoalescenceTree\+::get\+Seed (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a857521315ca6bd9b3300d099488d74f1}{}\label{class_tree_a857521315ca6bd9b3300d099488d74f1}


Getter for the simulation seed. 

\begin{DoxyReturn}{Returns}
Returns the seeds 
\end{DoxyReturn}
\index{CoalescenceTree@{CoalescenceTree}!import\+Maps@{import\+Maps}}
\index{import\+Maps@{import\+Maps}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{import\+Maps()}{importMaps()}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::import\+Maps (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a8e60e04be160c2d7de0ab1c834e6a95b}{}\label{class_tree_a8e60e04be160c2d7de0ab1c834e6a95b}


Imports the maps into the forestmap object. 

The simulation variables should have already been imported by \hyperlink{class_tree_ac374d237b7e2e7e11f6a0ff395003635}{set\+Parameters()}, otherwise a \hyperlink{struct_fatal___exception}{Fatal\+\_\+\+Exception} will be thrown. \index{CoalescenceTree@{CoalescenceTree}!import\+Simulation\+Variables@{import\+Simulation\+Variables}}
\index{import\+Simulation\+Variables@{import\+Simulation\+Variables}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{import\+Simulation\+Variables(vector$<$ string $>$ \&comargs)}{importSimulationVariables(vector< string > &comargs)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::import\+Simulation\+Variables (
\begin{DoxyParamCaption}
\item[{vector$<$ string $>$ \&}]{comargs}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a46fbbf6c52f7b2bfebb1ae0aac4df724}{}\label{class_tree_a46fbbf6c52f7b2bfebb1ae0aac4df724}


Import the simulation variables from the command line structure. 

This function parses the simulation variables, imports them (from either the command line or a config file), checks that the input files exist and checks for any paused simulations. The flags are then set correctly, meaning that \hyperlink{class_tree_aec10ea2b720edc13a38310afdfe2b6e4}{setup()} and run\+Sim() can be run immediately afterwards.


\begin{DoxyParams}{Parameters}
{\em comargs} & a vector of strings, containing the command-\/line arguments \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!import\+Simulation\+Variables@{import\+Simulation\+Variables}}
\index{import\+Simulation\+Variables@{import\+Simulation\+Variables}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{import\+Simulation\+Variables(string config\+\_\+file)}{importSimulationVariables(string config_file)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::import\+Simulation\+Variables (
\begin{DoxyParamCaption}
\item[{string}]{config\+\_\+file}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a8efc9557eb11e41dfdfd7c2c83682e06}{}\label{class_tree_a8efc9557eb11e41dfdfd7c2c83682e06}


Import the simulations variables from the specified config file. 


\begin{DoxyParams}{Parameters}
{\em config\+\_\+file} & the configuration file to import all variables from (both main simulation parameters and map simulation parameters. \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!output\+Data@{output\+Data}}
\index{output\+Data@{output\+Data}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{output\+Data(unsigned long species\+\_\+richness)}{outputData(unsigned long species_richness)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::output\+Data (
\begin{DoxyParamCaption}
\item[{unsigned long}]{species\+\_\+richness}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a5acf7d0eea9ea2ef4928bb6691b87724}{}\label{class_tree_a5acf7d0eea9ea2ef4928bb6691b87724}


Outputs important simulation data to a csv file. This function will likely be remove in future versions as all simulation output is now contained in an S\+Q\+Lite database. 


\begin{DoxyParams}{Parameters}
{\em species\+\_\+richness} & the species richness of the tree with the minimum speciation rate. Outputted into the csv file \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!parse\+Args@{parse\+Args}}
\index{parse\+Args@{parse\+Args}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{parse\+Args(vector$<$ string $>$ \&comargs)}{parseArgs(vector< string > &comargs)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::parse\+Args (
\begin{DoxyParamCaption}
\item[{vector$<$ string $>$ \&}]{comargs}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a518a17560e8550c650f3a76718580ff5}{}\label{class_tree_a518a17560e8550c650f3a76718580ff5}


Parses the command line arguments and saves the flags in \hyperlink{class_tree}{CoalescenceTree} for fullmode, resuming and other important variables.


\begin{DoxyParams}{Parameters}
{\em comargs} & \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!protracted\+Vars\+To\+String@{protracted\+Vars\+To\+String}}
\index{protracted\+Vars\+To\+String@{protracted\+Vars\+To\+String}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{protracted\+Vars\+To\+String()}{protractedVarsToString()}}]{\setlength{\rightskip}{0pt plus 5cm}string CoalescenceTree\+::protracted\+Vars\+To\+String (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{class_tree_aa8bb5d93c7992404ede0a49bb69ccd1f}{}\label{class_tree_aa8bb5d93c7992404ede0a49bb69ccd1f}


Outputs the protracted variables to a string. 

This function is intended to be overridden by derived classes. It is intended the output is used for writing to S\+QL databases.

\begin{DoxyReturn}{Returns}
string containing a list of the protracted speciation variables. 
\end{DoxyReturn}


Reimplemented in \hyperlink{class_protracted_tree_a0a899dcd433a3f8e752fa02640f561c0}{Protracted\+CoalescenceTree}.

\index{CoalescenceTree@{CoalescenceTree}!random\+List@{random\+List}}
\index{random\+List@{random\+List}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{random\+List(long maxnum, long numnum)}{randomList(long maxnum, long numnum)}}]{\setlength{\rightskip}{0pt plus 5cm}vector$<$ long $>$ CoalescenceTree\+::random\+List (
\begin{DoxyParamCaption}
\item[{long}]{maxnum, }
\item[{long}]{numnum}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a27bd274fe727892c84d153d9bd5ddbf0}{}\label{class_tree_a27bd274fe727892c84d153d9bd5ddbf0}


Deprecated function which generated a random list. 

\begin{DoxyRefDesc}{Deprecated}
\item[\hyperlink{deprecated__deprecated000005}{Deprecated}]Random lists are no longer required. \end{DoxyRefDesc}

\begin{DoxyParams}{Parameters}
{\em maxnum} & \\
\hline
{\em numnum} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
\index{CoalescenceTree@{CoalescenceTree}!remove\+Old\+Pos@{remove\+Old\+Pos}}
\index{remove\+Old\+Pos@{remove\+Old\+Pos}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{remove\+Old\+Pos(const unsigned long \&chosen)}{removeOldPos(const unsigned long &chosen)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::remove\+Old\+Pos (
\begin{DoxyParamCaption}
\item[{const unsigned long \&}]{chosen}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a351650bda95319b2213c2234fa930f49}{}\label{class_tree_a351650bda95319b2213c2234fa930f49}


Removes the old position within active by checking any wrapping and removing connections. 

The function also corrects the linked list to identify the correct nwrap for every wrapped lineage in that space.


\begin{DoxyParams}{Parameters}
{\em chosen} & the desired active reference to remove from the grid. \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!run\+Checks@{run\+Checks}}
\index{run\+Checks@{run\+Checks}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{run\+Checks(const unsigned long \&chosen, const unsigned long \&coalchosen)}{runChecks(const unsigned long &chosen, const unsigned long &coalchosen)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::run\+Checks (
\begin{DoxyParamCaption}
\item[{const unsigned long \&}]{chosen, }
\item[{const unsigned long \&}]{coalchosen}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a3820405a51ac9043346d37b0e267d364}{}\label{class_tree_a3820405a51ac9043346d37b0e267d364}


Run checks at the end of each cycle which make certain the move has been successful. 


\begin{DoxyParams}{Parameters}
{\em chosen} & the chosen lineage to check \\
\hline
{\em coalchosen} & the lineage which is coalescing with the chosen lineage which we are also required to check \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!run\+Simulation@{run\+Simulation}}
\index{run\+Simulation@{run\+Simulation}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{run\+Simulation()}{runSimulation()}}]{\setlength{\rightskip}{0pt plus 5cm}bool CoalescenceTree\+::run\+Simulation (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_afe75245862a1c40030c1c8607518cf8d}{}\label{class_tree_afe75245862a1c40030c1c8607518cf8d}


Run the entire simulation given the start conditions already defined by \hyperlink{class_tree_aec10ea2b720edc13a38310afdfe2b6e4}{setup()} 

Setup is assumed to have been run already. This function is the main function containing the main loop of the simulation. At the end of the simulation, returns true if the simulation is complete, false otherwise. \index{CoalescenceTree@{CoalescenceTree}!set\+Object\+Sizes@{set\+Object\+Sizes}}
\index{set\+Object\+Sizes@{set\+Object\+Sizes}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{set\+Object\+Sizes()}{setObjectSizes()}}]{\setlength{\rightskip}{0pt plus 5cm}unsigned long CoalescenceTree\+::set\+Object\+Sizes (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a869ab0aba75336f737cbb137c74b8abc}{}\label{class_tree_a869ab0aba75336f737cbb137c74b8abc}


Sets the sizes of grid, active and data, based on the number of individuals counted from the samplemask. 

\begin{DoxyReturn}{Returns}
a count of the number of individuals that exist in the simulation 
\end{DoxyReturn}
\index{CoalescenceTree@{CoalescenceTree}!set\+Parameters@{set\+Parameters}}
\index{set\+Parameters@{set\+Parameters}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{set\+Parameters()}{setParameters()}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::set\+Parameters (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_ac374d237b7e2e7e11f6a0ff395003635}{}\label{class_tree_ac374d237b7e2e7e11f6a0ff395003635}


Sets the map object with the correct variables, taking the \hyperlink{struct_sim_parameters}{Sim\+Parameters} structure defined elsewhere for the parameters. 

Requires that parameters have already been imported into the \hyperlink{struct_sim_parameters}{Sim\+Parameters}

This function can only be run once, otherwise a \hyperlink{struct_main___exception}{Main\+\_\+\+Exception} will be thrown \index{CoalescenceTree@{CoalescenceTree}!set\+Protracted\+Variables@{set\+Protracted\+Variables}}
\index{set\+Protracted\+Variables@{set\+Protracted\+Variables}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{set\+Protracted\+Variables(double speciation\+\_\+gen\+\_\+min, double speciation\+\_\+gen\+\_\+max)}{setProtractedVariables(double speciation_gen_min, double speciation_gen_max)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::set\+Protracted\+Variables (
\begin{DoxyParamCaption}
\item[{double}]{speciation\+\_\+gen\+\_\+min, }
\item[{double}]{speciation\+\_\+gen\+\_\+max}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{class_tree_a891764ffc1e29d3edbe0fd08e67a184b}{}\label{class_tree_a891764ffc1e29d3edbe0fd08e67a184b}


Sets the protracted variables. 


\begin{DoxyParams}{Parameters}
{\em speciation\+\_\+gen\+\_\+min} & the minimum number of generations to have passed before speciation is allowed \\
\hline
{\em speciation\+\_\+gen\+\_\+max} & the maximum number of generations a lineage can exist for before it is speciated. \\
\hline
\end{DoxyParams}


Reimplemented in \hyperlink{class_protracted_tree_a62128de5d5a6ed0dafc0492ec4ea27b7}{Protracted\+CoalescenceTree}.

\index{CoalescenceTree@{CoalescenceTree}!set\+Resume\+Parameters@{set\+Resume\+Parameters}}
\index{set\+Resume\+Parameters@{set\+Resume\+Parameters}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{set\+Resume\+Parameters(string pausedir, string outdir, unsigned long seed, unsigned long task, unsigned long new\+\_\+max\+\_\+time)}{setResumeParameters(string pausedir, string outdir, unsigned long seed, unsigned long task, unsigned long new_max_time)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::set\+Resume\+Parameters (
\begin{DoxyParamCaption}
\item[{string}]{pausedir, }
\item[{string}]{outdir, }
\item[{unsigned long}]{seed, }
\item[{unsigned long}]{task, }
\item[{unsigned long}]{new\+\_\+max\+\_\+time}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_ac545d844141db977920fc9fd76ce9dbb}{}\label{class_tree_ac545d844141db977920fc9fd76ce9dbb}


Sets the resume variables so that the simulation can be resumed. 

The pause directory can be the same as the output directory if it is desirable to save to the same location.


\begin{DoxyParams}{Parameters}
{\em pausedir} & the directory containing the pause folder for resuming the simulation \\
\hline
{\em outdir} & the directory to write simulation output to \\
\hline
{\em seed} & the simulation seed \\
\hline
{\em task} & the simulation task \\
\hline
{\em new\+\_\+max\+\_\+time} & the maximum simulation time to run for in seconds (0 keeps old simulation max time) \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!set\+Seed@{set\+Seed}}
\index{set\+Seed@{set\+Seed}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{set\+Seed(long long theseedin)}{setSeed(long long theseedin)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::set\+Seed (
\begin{DoxyParamCaption}
\item[{long long}]{theseedin}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a65f098693e08e33f039a8797ba57c3e0}{}\label{class_tree_a65f098693e08e33f039a8797ba57c3e0}


Sets the simulation seed to the provided variable. 

The seed is set within the NR object. This will be fixed for the simulation and is only performed once.


\begin{DoxyParams}{Parameters}
{\em theseedin} & the desired seed to set for the simulation \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!set\+Sim\+Start\+Variables@{set\+Sim\+Start\+Variables}}
\index{set\+Sim\+Start\+Variables@{set\+Sim\+Start\+Variables}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{set\+Sim\+Start\+Variables()}{setSimStartVariables()}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::set\+Sim\+Start\+Variables (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a1ba0f5d27c6ef6e9e17f988aff2dfe65}{}\label{class_tree_a1ba0f5d27c6ef6e9e17f988aff2dfe65}


Sets the variables at the start of a simulation for temporary data. 

This is not the main set-\/up routine, which creates the permanent data structures including maps, the coalescence tree and active lineage listings. \index{CoalescenceTree@{CoalescenceTree}!setup@{setup}}
\index{setup@{setup}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{setup()}{setup()}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::setup (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_aec10ea2b720edc13a38310afdfe2b6e4}{}\label{class_tree_aec10ea2b720edc13a38310afdfe2b6e4}


The setup function for generating the simulation objects. 

The simulation parameters are set from comargs using \hyperlink{class_tree_ac374d237b7e2e7e11f6a0ff395003635}{set\+Parameters()}. Generates and fills the active and grid objects as well as importing all the maps from the supplied files. It also checks for paused simulations and imports data if necessary from paused files. \hyperlink{class_tree_a8e60e04be160c2d7de0ab1c834e6a95b}{import\+Maps()} is called for importing the map files

\begin{DoxyRefDesc}{Bug}
\item[\hyperlink{bug__bug000001}{Bug}]For values of dispersal, forest transform rate and time since pristine (and any other double values), they will not be correctly outputted to the S\+I\+M\+U\+L\+A\+T\+I\+O\+N\+\_\+\+P\+A\+R\+A\+M\+E\+T\+E\+RS table if the value is smaller than 10e-\/6. The solution is to implement string output mechanisms using boost\+::lexical\+\_\+cast(), but this has so far only been deemed necessary for the speciation rate (which is intrinsically very small).\end{DoxyRefDesc}
\index{CoalescenceTree@{CoalescenceTree}!sim\+Resume@{sim\+Resume}}
\index{sim\+Resume@{sim\+Resume}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{sim\+Resume()}{simResume()}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::sim\+Resume (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a3d614f3848dc7acab168642efe345569}{}\label{class_tree_a3d614f3848dc7acab168642efe345569}


Resumes the simulation from a previous state. 

Reads in the parameters and objects from file and re-\/starts the simulation. \index{CoalescenceTree@{CoalescenceTree}!speciation@{speciation}}
\index{speciation@{speciation}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{speciation(const unsigned long \&chosen)}{speciation(const unsigned long &chosen)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::speciation (
\begin{DoxyParamCaption}
\item[{const unsigned long \&}]{chosen}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a05c9e44f1a4d7af83e65b6c4565b1b28}{}\label{class_tree_a05c9e44f1a4d7af83e65b6c4565b1b28}


Speciation to supplied lineage. 

Also calls the \hyperlink{class_tree_a351650bda95319b2213c2234fa930f49}{remove\+Old\+Pos()} and \hyperlink{class_tree_a89e2fa28e3d637b4bc034fb3afc53e81}{switch\+Positions()} functions for removing the lineage out of active reference. 
\begin{DoxyParams}{Parameters}
{\em chosen} & \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!sql\+Output@{sql\+Output}}
\index{sql\+Output@{sql\+Output}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{sql\+Output()}{sqlOutput()}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::sql\+Output (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a8cd3db7add1884ea53b0d98002d39cd3}{}\label{class_tree_a8cd3db7add1884ea53b0d98002d39cd3}


Copy the in-\/memory database to file. 

This function should not be called if the database is already opened on disc, and won\textquotesingle{}t do anything if it is. \index{CoalescenceTree@{CoalescenceTree}!stop\+Simulation@{stop\+Simulation}}
\index{stop\+Simulation@{stop\+Simulation}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{stop\+Simulation()}{stopSimulation()}}]{\setlength{\rightskip}{0pt plus 5cm}bool CoalescenceTree\+::stop\+Simulation (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_afd6bd75c301d2f57c4997fcfc92f192e}{}\label{class_tree_afd6bd75c301d2f57c4997fcfc92f192e}


Finalises the simulation, and performs the correct tasks depending if the sim has been paused or finished. 

\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
\index{CoalescenceTree@{CoalescenceTree}!switch\+Positions@{switch\+Positions}}
\index{switch\+Positions@{switch\+Positions}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{switch\+Positions(const unsigned long chosen)}{switchPositions(const unsigned long chosen)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::switch\+Positions (
\begin{DoxyParamCaption}
\item[{const unsigned long}]{chosen}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a89e2fa28e3d637b4bc034fb3afc53e81}{}\label{class_tree_a89e2fa28e3d637b4bc034fb3afc53e81}


Switches the chosen position with the endactive position. 


\begin{DoxyParams}{Parameters}
{\em chosen} & the chosen lineage to switch with endactive. \\
\hline
\end{DoxyParams}
\index{CoalescenceTree@{CoalescenceTree}!validate\+Lineages@{validate\+Lineages}}
\index{validate\+Lineages@{validate\+Lineages}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{validate\+Lineages()}{validateLineages()}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::validate\+Lineages (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_a4918f354073488d7ace09fd80cd8991c}{}\label{class_tree_a4918f354073488d7ace09fd80cd8991c}


Validates all lineages have been set up correctly. This may take considerable time for larger simulations. 

This function is only relevant in debug mode. \index{CoalescenceTree@{CoalescenceTree}!validation\+Check@{validation\+Check}}
\index{validation\+Check@{validation\+Check}!CoalescenceTree@{CoalescenceTree}}
\subsubsection[{\texorpdfstring{validation\+Check(const unsigned long \&chosen, int o, const unsigned long \&current, const bool \&coal)}{validationCheck(const unsigned long &chosen, int o, const unsigned long &current, const bool &coal)}}]{\setlength{\rightskip}{0pt plus 5cm}void CoalescenceTree\+::validation\+Check (
\begin{DoxyParamCaption}
\item[{const unsigned long \&}]{chosen, }
\item[{int}]{o, }
\item[{const unsigned long \&}]{current, }
\item[{const bool \&}]{coal}
\end{DoxyParamCaption}
)}\hypertarget{class_tree_aa60dbbf173231fb224e2c6792cbae292}{}\label{class_tree_aa60dbbf173231fb224e2c6792cbae292}


Validates the chosen lineage is set up correctly. 

This function is for debugging purposes. It checks that the wrapping of the lineage in active is correct, and links to other lineages are applied correctly.


\begin{DoxyParams}{Parameters}
{\em chosen} & the desired lineage to check \\
\hline
{\em o} & an integer for outputting and referencing later on \\
\hline
{\em current} & the current lineage in memory, again for referencing purposes. \\
\hline
{\em coal} & boolean for whether coalescence has occured. \\
\hline
\end{DoxyParams}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\hyperlink{_tree_8h}{CoalescenceTree.\+h}\item
\hyperlink{_tree_8cpp}{CoalescenceTree.\+cpp}\end{DoxyCompactItemize}
