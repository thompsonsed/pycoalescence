<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pycoalescence &#8212; pycoalescence 1.2.7a2 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/collapsible-lists/css/tree_view.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.2.7a2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
    <script type="text/javascript" src="_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
    <link rel="shortcut icon" href="_static/PyCoal_favicon_large.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="necsim" href="necsim/necsim_library.html" />
    <link rel="prev" title="Welcome to pycoalescence" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="necsim/necsim_library.html" title="necsim"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to pycoalescence"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pycoalescence 1.2.7a2 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="pycoalescence">
<h1>pycoalescence<a class="headerlink" href="#pycoalescence" title="Permalink to this headline">¶</a></h1>
<table border="1" class="colwidths-auto docutils align-center">
<thead valign="bottom">
<tr class="row-odd"><th class="head">Documentation</th>
<th class="head">Examples</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference external" href="https://pycoalescence.readthedocs.io"><img alt="Documentation" src="https://readthedocs.org/projects/pip/badge/?version=latest&amp;style=flat" /></a></td>
<td><a class="reference external" href="https://mybinder.org/v2/gh/thompsonsed/pycoalescence_examples/master?filepath=%2Fhome%2Fpycoalescence_examples%2F"><img alt="Binder" src="https://mybinder.org/badge.svg" /></a></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<table border="1" class="colwidths-auto docutils align-center">
<thead valign="bottom">
<tr class="row-odd"><th class="head">Windows</th>
<th class="head">macOS</th>
<th class="head">Linux</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference external" href="https://ci.appveyor.com/project/thompsonsed1992/pycoalescence-ci"><img alt="AppVeyorWin" src="https://ci.appveyor.com/api/projects/status/3qex6in9w1384f57/branch/master?svg=true" /></a></td>
<td><a class="reference external" href="https://travis-ci.org/pycoalescence/pycoalescence-ci"><img alt="TravisCI" src="https://travis-ci.org/pycoalescence/pycoalescence-ci.svg?branch=master" /></a></td>
<td><a class="reference external" href="https://circleci.com/bb/thompsonsed/pycoalescence"><img alt="CircleCI" src="https://circleci.com/bb/thompsonsed/pycoalescence.svg?style=svg" /></a></td>
</tr>
</tbody>
</table>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p><strong>pycoalescence</strong> is a Python module for the spatially-explicit coalescence neutral simulator, necsim, described
<a class="reference internal" href="necsim/necsim_library.html#introduction-necsim"><span class="std std-ref">here</span></a>. <strong>pycoalescence</strong> provides a pythonic interface to the C++ simulator for swift
simulation set-up, initiation and analysis.</p>
</div>
<div class="section" id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<p>A large number of performance-enhancing features have been implemented, as well as support for a wide number of
scenarios. The features include:</p>
<ul class="simple">
<li>Coalescence methods for excellent performance.</li>
<li>Full output of community structure, with species IDs generated for every individual.</li>
<li>Full spatial modelling, using a dispersal kernel to simulate spatial dynamics.</li>
<li>Multiple sampling points, both spatially and temporally.</li>
<li>Simulations of a region much larger than the sample area.</li>
<li>Calculation of many biodiversity metrics, including species richness, species abundances, beta-diversity and
locations of lineages.</li>
<li>Usage of protracted speciation to restrict the time period that speciation events can occur in.</li>
<li>Generate and apply a metacommunity to a simulation without requiring a new simulation to be performed.</li>
<li>Scalability - support for simulations of tens or hundreds of millions of individuals in a single simulation.</li>
</ul>
</div>
<div class="section" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#installation" id="id7">Installation</a></li>
<li><a class="reference internal" href="#performing-simulations" id="id8">Performing simulations</a></li>
<li><a class="reference internal" href="#post-simulation-analysis" id="id9">Post-simulation analysis</a></li>
<li><a class="reference internal" href="#extended-analysis" id="id10">Extended analysis</a></li>
<li><a class="reference internal" href="#additional-package-features" id="id11">Additional Package Features</a></li>
<li><a class="reference internal" href="#testing-install" id="id12">Testing install</a></li>
</ul>
</div>
<div class="section" id="installation">
<h3><a class="toc-backref" href="#id7">Installation</a><a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>Two methods of installation are recommended: using conda to handle package management, including installation of all
dependencies, or using <a class="reference external" href="https://pypi.org/project/pip/">pip</a> into Python virtual environments
(see <a class="reference external" href="http://docs.python-guide.org/en/latest/dev/virtualenvs/">here</a> for good advice).</p>
<p>The other methods of installing listed here are provided as references to the install process itself, and to provide
finer control over installation methods if difficulties are encountered. Note that pip and conda both internally call
setuptools, which in turn runs <code class="docutils literal"><span class="pre">installer.py</span></code>.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Mac OS X and Linux are supported through pip. Mac OS, Linux and Windows are supported through conda.
For manual installation it should be possible install <strong>pycoalescence</strong> on any system, but may require
some tinkering.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Whichever installation option you use, it is important to ensure that the package is compiled in the same
environment as you intend to run simulations.</p>
</div>
<div class="section" id="installing-via-conda">
<h4>Installing via conda<a class="headerlink" href="#installing-via-conda" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://conda.io/docs/">Conda</a> is a package manager that handles sourcing of all dependencies in a relatively
straight-forward, cross-platform manner. <strong>pycoalescence</strong> is provided on conda-forge. Installation of the package and
all dependencies including boost, gdal, cmake and the relevant C++ compiler, simply requires
<code class="docutils literal"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">-c</span> <span class="pre">conda-forge</span> <span class="pre">pycoalescence</span></code>. Note that conda installs the dependencies into its own environment and
may ignore system installs.</p>
<div class="section" id="conda-on-linux">
<h5>conda on Linux<a class="headerlink" href="#conda-on-linux" title="Permalink to this headline">¶</a></h5>
<p>C++14 compilers are currently unsupported on Linux on conda-forge, meaning that installation through this channel is not
possible at this time. The solution is to build the package recipe on your local machine using the following steps
(requires git and conda are installed locally).</p>
<ul>
<li><p class="first">Change directory to a temporary directory and source the base conda environment</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">cd</span> <span class="pre">temp</span></code></li>
<li><code class="docutils literal"><span class="pre">source</span> <span class="pre">/path/anaconda3/bin/activate</span></code></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Download the recipe from conda-forge using git and modify the recipe to include linux</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">https://github.com/conda-forge/pycoalescence-feedstock.git</span></code></li>
<li>Delete &#8220;or linux&#8221; from line 18 in pycoalescence-feedstock/recipes/meta.yaml. This will allow the build on linux
systems.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Build the package (make sure conda-build package has been installed) and install the package to your desired
environment.</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">conda-build</span> <span class="pre">.</span></code> (this step takes some time)</li>
<li><code class="docutils literal"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">--use-local</span> <span class="pre">pycoalescence</span> <span class="pre">--name</span> <span class="pre">MyEnv</span></code></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When the C++ compilers are updated on conda-forge, this method for installing on Linux will no longer be
necessary.</p>
</div>
</div>
</div>
<div class="section" id="installing-via-pip">
<h4>Installing via pip<a class="headerlink" href="#installing-via-pip" title="Permalink to this headline">¶</a></h4>
<p>Installation via pip requires that the non-pythonic dependencies are installed manually first. Importantly, make sure that
<a class="reference external" href="http://www.gdal.org/">gdal</a> is fully functional. On some systems this appears to need compilation directly from
source. Also ensure that you have a C++14 compliant compiler, <a class="reference external" href="https://cmake.org/">cmake</a>,
<a class="reference external" href="https://www.sqlite.org/download.html">sqlite</a> and <a class="reference external" href="http://www.boost.org">boost</a> installed. Finally make sure
your Python 3 is &gt;= 3.4 or Python 2 &gt;= 2.7.9.</p>
<p>With all requirements installled, it is recommended that you use a virtual environment (or pipenv) to control your
Python packages (<a class="reference external" href="http://docs.python-guide.org/en/latest/dev/virtualenvs/">see here</a>).</p>
<p>Finally, installation of <strong>pycoalescence</strong>, including Python dependencies, should just require
<code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pycoalescence</span></code>. The package should be downloaded and built.</p>
</div>
<div class="section" id="installing-manually-setuptools">
<h4>Installing manually - setuptools<a class="headerlink" href="#installing-manually-setuptools" title="Permalink to this headline">¶</a></h4>
<p>This method is not recommended unless you experience problems with conda or pip. To install using setuptools, download
the source code manually and run <code class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></code> from the terminal. Running this command will install
<strong>pycoalescence</strong> to the current Python environment.</p>
</div>
<div class="section" id="installing-manually-installer-py">
<h4>Installing manually - installer.py<a class="headerlink" href="#installing-manually-installer-py" title="Permalink to this headline">¶</a></h4>
<p>Calling <code class="docutils literal"><span class="pre">python</span> <span class="pre">installer.py</span> <span class="pre">[opts]</span></code> from the <em>pycoalescence</em> directory within the source code allows for finer
control over installation options. Importantly, two different make environments can be used, either ./configure and
make, or cmake. A list of options is given below, and can also be displayed by running <code class="docutils literal"><span class="pre">python</span> <span class="pre">installer.py</span> <span class="pre">-h</span></code>.
Running <code class="docutils literal"><span class="pre">python</span> <span class="pre">installer.py</span></code> will generate the package in-place, meaning that it will not be added to the Python
environment. This can be desirable for HPC systems where package installation is not permitted.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="72%" />
<col width="9%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Option</td>
<td>Description</td>
<td>Default</td>
</tr>
<tr class="row-even"><td>&#8211;cmake</td>
<td>Build the C++ library (necsim) required for pycoalescence.</td>
<td>True</td>
</tr>
<tr class="row-odd"><td>&#8211;autotools</td>
<td>Use the autotools build process (./configure and make)</td>
<td>False</td>
</tr>
<tr class="row-even"><td>&#8211;compiler-args</td>
<td>Additional arguments to pass to the autotools compiler</td>
<td>None</td>
</tr>
<tr class="row-odd"><td>&#8211;cmake-args</td>
<td>Additional arguments to pass to the cmake compiler during configuration</td>
<td>None</td>
</tr>
<tr class="row-even"><td>&#8211;cmake-build-args</td>
<td>Additional arguments to pass to the cmake compiler at build time</td>
<td>None</td>
</tr>
<tr class="row-odd"><td>&#8211;debug</td>
<td>Compile using DEBUG defines</td>
<td>False</td>
</tr>
<tr class="row-even"><td>-c -C &#8211;compile</td>
<td>Compile only, do not re-configure necsim</td>
<td>False</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="hpc-installation">
<h4>HPC installation<a class="headerlink" href="#hpc-installation" title="Permalink to this headline">¶</a></h4>
<p>On systems where package installation is not possible, use <code class="docutils literal"><span class="pre">python</span> <span class="pre">installer.py</span></code> to build the package in-place.
Alternatively, <code class="docutils literal"><span class="pre">python</span> <span class="pre">hpc_setup.py</span></code> provides a custom installation with a few options switched on for HPC systems,
including usage of the intel compiler by default and optimisation flags for HPC. Note that this option uses the
autotools process (<code class="docutils literal"><span class="pre">./configure</span></code> and <code class="docutils literal"><span class="pre">make</span></code>) instead of cmake for compilation.</p>
</div>
<div class="section" id="installation-issues">
<h4>Installation issues<a class="headerlink" href="#installation-issues" title="Permalink to this headline">¶</a></h4>
<p>Consider using <a class="reference external" href="https://conda.io/docs/">conda</a> to manage package dependencies if you experience issues and please
report any problems you have. On Mac OS X, installation via pip requires that the dependencies have already been
provided.</p>
<p>The most common issue for installing <strong>pycoalescence</strong> is gdal dependencies not being found (including errors relating
to cpl_error.h, gdal.h, gdal_priv.h or cpl_conv.h). This is usually the result of gdal installing in a non-standard
location, or the header files not being included with the gdal install. To fix this, install the C++ library on your
system first. Then download the Python package from <a class="reference external" href="https://pypi.org/project/GDAL/#files">here</a>, and run
<code class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">build</span></code> from the gdal directory. If this is successful, run <code class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></code> to install
gdal to your Python environment.</p>
<p>For issues related to missing boost headers, make sure that your system has boost properly installed.</p>
</div>
</div>
<div class="section" id="performing-simulations">
<span id="id2"></span><h3><a class="toc-backref" href="#id8">Performing simulations</a><a class="headerlink" href="#performing-simulations" title="Permalink to this headline">¶</a></h3>
<p>Check out the full simulation examples in <a class="reference internal" href="src/examples.html"><span class="doc">this jupyter notebook</span></a>.</p>
<div class="section" id="setting-up-simulations">
<h4>Setting up simulations<a class="headerlink" href="#setting-up-simulations" title="Permalink to this headline">¶</a></h4>
<p>The process of setting up a <a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation" title="pycoalescence.simulation.Simulation"><code class="xref py py-class docutils literal"><span class="pre">Simulation</span></code></a> object is outlined below.</p>
<ol class="arabic">
<li><p class="first">Instantiate our <a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation" title="pycoalescence.simulation.Simulation"><code class="xref py py-class docutils literal"><span class="pre">Simulation</span></code></a> object using
<code class="code pycode python docutils literal"><span class="name"><span class="pre">sim</span></span> <span class="operator"><span class="pre">=</span></span> <span class="name"><span class="pre">Simulation</span></span><span class="punctuation"><span class="pre">(</span></span><span class="name"><span class="pre">logging_level</span></span><span class="operator"><span class="pre">=</span></span><span class="literal number integer"><span class="pre">20</span></span><span class="punctuation"><span class="pre">)</span></span></code> where the logging level corresponds to the amount of information that is
displayed using <a class="reference external" href="https://docs.python.org/3/library/logging.html">Python&#8217;s logging module</a> (20 corresponds to
&#8220;info&#8221;, the second highest display level, after &#8220;debug&#8221;).</p>
</li>
<li><p class="first">Specify simulation parameters</p>
<ul>
<li><p class="first">Use <a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.set_simulation_parameters" title="pycoalescence.simulation.Simulation.set_simulation_parameters"><code class="xref py py-func docutils literal"><span class="pre">set_simulation_parameters()</span></code></a>
to set the job number, task number, output directory and other key simulation variables.</p>
</li>
<li><p class="first">Set the map variables by one of the following:</p>
<ol class="loweralpha simple">
<li><a class="reference internal" href="pycoalescence.html#pycoalescence.landscape.Landscape.set_map_parameters" title="pycoalescence.landscape.Landscape.set_map_parameters"><code class="xref py py-func docutils literal"><span class="pre">set_map_parameters()</span></code></a> to input file paths and dimensions</li>
<li><a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.set_map_files" title="pycoalescence.simulation.Simulation.set_map_files"><code class="xref py py-func docutils literal"><span class="pre">set_map_files()</span></code></a> to set the map file paths. This
calls <a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.detect_map_dimensions" title="pycoalescence.simulation.Simulation.detect_map_dimensions"><code class="xref py py-func docutils literal"><span class="pre">detect_map_dimensions()</span></code></a> to automatically
detect file offsets and dimensions.</li>
</ol>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Check <a class="reference internal" href="#limitations-of-simulation-variables">Limitations of simulation variables</a> for important information on restrictions on simulation
inputs.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.detect_map_dimensions" title="pycoalescence.simulation.Simulation.detect_map_dimensions"><code class="xref py py-func docutils literal"><span class="pre">detect_map_dimensions()</span></code></a> requires
that the files are in <strong>.tif</strong> formats so that file dimensions can be read. If input files are csv format,
method a) should be used.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">One can specify either &#8220;null&#8221; or &#8220;none&#8221; map types; &#8220;null&#8221; creates a map at the specified
size, whereas &#8220;none&#8221; creates hard boundaries without any in-memory map object created at all. However,
the dimensions of these files must be manually supplied.</p>
</div>
</li>
<li><p class="first">Optionally, also run <a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.set_speciation_rates" title="pycoalescence.simulation.Simulation.set_speciation_rates"><code class="xref py py-func docutils literal"><span class="pre">set_speciation_rates()</span></code></a>
to set a list of speciation rates to apply at the end of the simulation.</p>
</li>
</ul>
</li>
<li><p class="first">Run the simulation
This is split into 3 parts, which can be called individually if necessary:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">Finalise setup</p>
<blockquote>
<div><ul class="simple">
<li>Run <a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.finalise_setup" title="pycoalescence.simulation.Simulation.finalise_setup"><code class="xref py py-func docutils literal"><span class="pre">finalise_setup()</span></code></a> to check that simulations
are setup and set up the maps and data structures in memory <a class="reference internal" href="necsim/necsim_library.html#introduction-necsim"><span class="std std-ref">necsim</span></a>.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Run simulations</p>
<blockquote>
<div><ul class="simple">
<li>Start the simulation using <a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.run_coalescence" title="pycoalescence.simulation.Simulation.run_coalescence"><code class="xref py py-func docutils literal"><span class="pre">run_coalescence()</span></code></a></li>
<li>Returns True if the simulations complete successfully and False if the simulations run out of time and pause</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Apply speciation rates and output database</p>
<blockquote>
<div><ul class="simple">
<li>Generate a coalescence tree for each speciation rate using
<code class="xref py py-func docutils literal"><span class="pre">apply_speciation_rates()</span> <span class="pre">&lt;pycoalescence.simulation.Simulation.apply_speciation_rates()</span></code></li>
<li>This function also writes the output to the simulation file.</li>
</ul>
</div></blockquote>
</li>
</ol>
</div></blockquote>
</li>
</ol>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The last three steps can be combined using <a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.run" title="pycoalescence.simulation.Simulation.run"><code class="xref py py-func docutils literal"><span class="pre">run()</span></code></a>,
which also performs checks for if the simulation has run out of time and paused, rather than completing.</p>
</div>
<p>See the <a class="reference internal" href="#sim-examples"><span class="std std-ref">examples</span></a> for the full simulation process.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See <a class="reference internal" href="#glossary">Glossary</a> for definitions of <a class="reference internal" href="#term-sample-map"><span class="xref std std-term">sample map</span></a>, <a class="reference internal" href="#term-fine-map"><span class="xref std std-term">fine map</span></a> and <a class="reference internal" href="#term-coarse-map"><span class="xref std std-term">coarse map</span></a>.</p>
</div>
</div>
<div class="section" id="key-features">
<h4>Key Features<a class="headerlink" href="#key-features" title="Permalink to this headline">¶</a></h4>
<p>Some of key simulation features are listed below.</p>
<ul class="simple">
<li><strong>Set differing landscape types</strong> using fine and coarse density maps, both current and historical (see
<a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.set_map_files" title="pycoalescence.simulation.Simulation.set_map_files"><code class="xref py py-func docutils literal"><span class="pre">set_map_files()</span></code></a> and
<a class="reference internal" href="pycoalescence.html#pycoalescence.landscape.Landscape.add_historical_map" title="pycoalescence.landscape.Landscape.add_historical_map"><code class="xref py py-func docutils literal"><span class="pre">add_historical_map()</span></code></a>).</li>
<li><strong>Specify a sampling mask</strong>, as a binary sampling mask defining areas to sample from (the sample map). Alternatively,
for varying sampling effort across space choose <cite>uses_spatial_sampling=True</cite> in
<a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.set_simulation_parameters" title="pycoalescence.simulation.Simulation.set_simulation_parameters"><code class="xref py py-func docutils literal"><span class="pre">set_simulation_parameters()</span></code></a>.</li>
<li><strong>Multiple sampling points in time</strong> using
<a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.add_sample_time" title="pycoalescence.simulation.Simulation.add_sample_time"><code class="xref py py-func docutils literal"><span class="pre">add_sample_time()</span></code></a>.</li>
<li><strong>Protracted speciation simulations</strong> using <cite>protracted=True</cite> in
<a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.set_simulation_parameters" title="pycoalescence.simulation.Simulation.set_simulation_parameters"><code class="xref py py-func docutils literal"><span class="pre">set_simulation_parameters()</span></code></a>.</li>
<li><strong>Non-spatial simulations</strong> using <cite>spatial=False</cite> in
<a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.set_simulation_parameters" title="pycoalescence.simulation.Simulation.set_simulation_parameters"><code class="xref py py-func docutils literal"><span class="pre">set_simulation_parameters()</span></code></a>.</li>
<li><strong>Spatial simulations using a variety of dispersal kernels</strong>. This is the default, using a normally-distributed
dispersal kernel. For other kernels see <a class="reference internal" href="#disp-kernels"><span class="std std-ref">here</span></a>.</li>
<li><strong>Varying reproductive rates across space</strong> using a map of relative reproductive rates. See <a class="reference internal" href="#rep-map"><span class="std std-ref">here</span></a>.</li>
<li><strong>Varying death rates across space</strong> using a map of relative death rates. See <a class="reference internal" href="#rep-map"><span class="std std-ref">here</span></a>.</li>
<li><strong>Varying landscape types</strong> including infinite landscapes, infinitely tiled landscapes of the coarse or fine density
map and closed landscapes with hard boundaries. See <a class="reference internal" href="#inf-land"><span class="std std-ref">here</span></a>.</li>
</ul>
</div>
<div class="section" id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h4>
<p>Some basic examples are given below. For more complicated scenarios, including examples of fetching data from completed
simulations, please see <a class="reference internal" href="src/examples.html"><span class="doc">this jupyter notebook</span></a>.</p>
<p>A simple simulation</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pycoalescence</span> <span class="kn">import</span> <span class="n">Simulation</span>
<span class="c1"># set logging level to &quot;info&quot; (from logging module)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="n">logging_level</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1"># set the main simulation parameters - use default values for other keyword arguments</span>
<span class="n">c</span><span class="o">.</span><span class="n">set_simulation_parameters</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">job_type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">output_directory</span><span class="o">=</span><span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="n">min_speciation_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                            <span class="n">sigma</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">deme</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">max_time</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># optionally add a set of speciation rates to apply at the end of the simulation</span>
<span class="n">c</span><span class="o">.</span><span class="n">set_speciation_rates</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
<span class="c1"># set the map parameters - null means the map will be generated with 100% cover everywhere (no file input).</span>
<span class="n">c</span><span class="o">.</span><span class="n">set_map_parameters</span><span class="p">(</span><span class="n">sample_file</span> <span class="o">=</span> <span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="n">sample_x</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">sample_y</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                     <span class="n">fine_file</span> <span class="o">=</span> <span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="n">fine_x</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">fine_y</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">fine_x_offset</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fine_y_offset</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
                     <span class="n">coarse_file</span> <span class="o">=</span> <span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="n">coarse_x</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">coarse_y</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
                     <span class="n">coarse_x_offset</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">coarse_y_offset</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">coarse_scale</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                     <span class="n">historical_fine_map</span> <span class="o">=</span> <span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="n">historical_coarse_map</span> <span class="o">=</span> <span class="s2">&quot;null&quot;</span><span class="p">)</span>
<span class="c1"># run checks, complete the simulation and output the database</span>
<span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>A more complex example using multiple temporal sampling points and detection of map dimensions from the
inputted map files.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pycoalescence</span> <span class="kn">import</span> <span class="n">Simulation</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">()</span>
<span class="c1"># set the main simulation parameters</span>
<span class="n">c</span><span class="o">.</span><span class="n">set_simulation_parameters</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">job_type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">output_directory</span><span class="o">=</span><span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="n">min_speciation_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                            <span class="n">sigma</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">deme</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mf">0.1</span>
                            <span class="n">max_time</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">dispersal_method</span><span class="o">=</span><span class="s2">&quot;fat-tailed&quot;</span><span class="p">,</span> <span class="n">m_prob</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                            <span class="n">dispersal_relative_cost</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_num_species</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">habitat_change_rate</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                            <span class="n">gen_since_historical</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">time_config_file</span><span class="o">=</span><span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="n">restrict_self</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                            <span class="n">landscape_type</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="c1"># add a set of speciation rates to be applied at the end of the simulation</span>
<span class="n">c</span><span class="o">.</span><span class="n">set_speciation_rates</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
<span class="c1"># set the map files - note that dimensions and offsets are detected automatically from the files</span>
<span class="n">c</span><span class="o">.</span><span class="n">set_map_files</span><span class="p">(</span><span class="n">sample_file</span><span class="o">=</span><span class="s2">&quot;null&quot;</span><span class="p">,</span> <span class="n">fine_file</span><span class="o">=</span><span class="s2">&quot;path/to/fine.tif&quot;</span><span class="p">,</span> <span class="n">coarse_file</span><span class="o">=</span><span class="s2">&quot;path/to/coarse.tif&quot;</span><span class="p">)</span>
<span class="c1"># add sample times</span>
<span class="n">c</span><span class="o">.</span><span class="n">add_sample_time</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">add_sample_time</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="c1"># add historical maps</span>
<span class="n">c</span><span class="o">.</span><span class="n">add_historical_map</span><span class="p">(</span><span class="n">fine_map</span><span class="o">=</span><span class="s2">&quot;path/to/historicalfine1.tif&quot;</span><span class="p">,</span> <span class="n">coarse_map</span><span class="o">=</span><span class="s2">&quot;path/to/historicalcoarse1.tif&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
 <span class="n">rate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1"># run checks, complete the simulation and output the database</span>
<span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">necsim can also be run directly using command line arguments (see
<a class="reference internal" href="necsim/necsim_library.html#introduction-necsim"><span class="std std-ref">Introduction to necsim</span></a>), but this is not recommended.</p>
</div>
</div>
<div class="section" id="dispersal-kernels">
<h4>Dispersal Kernels<a class="headerlink" href="#dispersal-kernels" title="Permalink to this headline">¶</a></h4>
<p>Three different dispersal functions are currently supported, which take some combination of the <em>sigma</em> (<span class="math">\(\sigma\)</span>)
, <em>tau</em> (<span class="math">\(\tau\)</span> ), <em>m_prob</em> (<span class="math">\(m\)</span> ) and <em>cutoff</em> (<span class="math">\(c\)</span> ) dispersal parameters. You only need to provide
the required parameters for each dispersal method; any additional parameters provided will be ignored.</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Normal distribution (the default)</dt>
<dd>This requires <span class="math">\(\sigma\)</span> only (the standard deviation). The outputted dispersal kernel in two dimensions
will follow a Rayleigh distribution for dispersal distance, <span class="math">\(N(r)\)</span></dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Fat-tailed distribution</dt>
<dd>This requires both <span class="math">\(\sigma\)</span> and <span class="math">\(\tau\)</span>. Importantly, for our fat-tailed dispersal kernel, <span class="math">\(F(r)\)</span>,
<span class="math">\(\lim{\tau \to \inf} = N(r)\)</span>. Within this dispersal kernel, there is an increased chance of long-distance
dispersal (but lower than the normal-uniform dispersal kernel).</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Normal-uniform distribution</dt>
<dd>This requires <span class="math">\(\sigma\)</span>, <span class="math">\(m\)</span> and <span class="math">\(c\)</span> . Here, we pick with probability <span class="math">\(1-m\)</span> from a normal
distribution with standard deviation <span class="math">\(\sigma\)</span>, and probability <span class="math">\(m\)</span> from a uniform distribution. This
uniform distribution picks a random distance uniformly between 0 and <span class="math">\(c\)</span>, the maximal dispersal distance. For
very large <span class="math">\(c\)</span>, extremely long distance dispersal is possible.</dd>
</dl>
</li>
</ul>
<p>It is also possible to provide a dispersal probability map, which sets the probability of dispersing from one cell to
another. The dispersal map should be dimensions <em>xy</em> by <em>xy</em> where <em>x</em> and <em>y</em> are the dimensions of the fine map. A
dispersal map can be set by using
<a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.set_map_files" title="pycoalescence.simulation.Simulation.set_map_files"><code class="xref py py-func docutils literal"><span class="pre">set_map_files(dispersal_map=&quot;/path/to/dispersal.tif&quot;)</span></code></a>.</p>
<p><strong>pycoalescence</strong> has the ability to simulate a dispersal kernel on a landscape. For more information about that
process, see <a class="reference internal" href="README_landscapes.html#simulate-landscapes"><span class="std std-ref">here</span></a>.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">In this scenario, it is not possible to use a coarse map, which should be &#8220;none&#8221;.</p>
</div>
</div>
<div class="section" id="differing-demographic-rates">
<h4>Differing demographic rates<a class="headerlink" href="#differing-demographic-rates" title="Permalink to this headline">¶</a></h4>
<p>Simulations can use varying reproductive and/or death rates across the landscape, but using
<a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.set_map_files" title="pycoalescence.simulation.Simulation.set_map_files"><code class="xref py py-func docutils literal"><span class="pre">set_map_files(reproduction_map=&quot;/path/to/rep.tif&quot;,</span> <span class="pre">death_map=&quot;/path/to/death.tif&quot;)</span></code></a>.
In this scenario, all species have different per-capita reproduction and death rates across the landscape.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Density is already taken into account during simulations for reproduction rates, so the reproduction map
should be solely for the <em>per-capita</em> differences in reproductive rate.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In a neutral model, each death event is followed by a birth event. The death map therefore represents both the
relative number of deaths, and the relative number of maturations in each cell. The reproduction map instead
indicates the relative number of propagules generated by each cell which may end up dispersing and maturing at
other locations.</p>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The reproduction and death maps can only be used with a fine map, and coarse map should be set to &#8220;none&#8221;.</p>
</div>
</div>
<div class="section" id="limitations-of-simulation-variables">
<h4>Limitations of simulation variables<a class="headerlink" href="#limitations-of-simulation-variables" title="Permalink to this headline">¶</a></h4>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">This section contains key information about the simulation inputs. Please read carefully to minimise any
unnecessary bugs.</p>
</div>
<p>Certain simulation variables have limitations, depending on the method of setting up the simulation.</p>
<ul>
<li><p class="first">Map variables set up using <a class="reference internal" href="pycoalescence.html#pycoalescence.landscape.Landscape.set_map_parameters" title="pycoalescence.landscape.Landscape.set_map_parameters"><code class="xref py py-func docutils literal"><span class="pre">set_map_parameters()</span></code></a></p>
<blockquote>
<div><ul class="simple">
<li>Sample map dimensions must be smaller than fine map dimensions.</li>
<li>Fine map dimensions must be smaller than coarse map dimensions (supplied at the resolution of the fine map files).</li>
<li>Dimensions of historical fine and coarse maps must match their respective current map dimensions.</li>
<li>All offsets must maintain the smaller map within the larger map</li>
<li>If any files are supplied as &#8216;null&#8217;, map sizes must still be provided. This is important for sample map size, but
should be corrected in a future update for coarse map files.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Map files (and variables) set using <a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.set_map_files" title="pycoalescence.simulation.Simulation.set_map_files"><code class="xref py py-func docutils literal"><span class="pre">set_map_files()</span></code></a></p>
<blockquote>
<div><ul class="simple">
<li>In addition to the above conditions being true, the files must all be georeferenced, so that coarse and fine map
dimensions will be read correctly.</li>
</ul>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Use a GIS program (such as ArcGIS or QGIS) for manipulation of map files to
ensure georeferencing is preserved.</p>
</div>
<ul class="simple">
<li>If the samplemask map is &#8220;null&#8221;, the program will read the dimensions from the fine map and choose that as the
area to sample entirely over. Supplying &#8220;null&#8221; will therefore sample the entirety of the fine map.</li>
</ul>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">Scalings and offsets between maps should also work correctly, but if problems are encountered, try manually
specifying offsets and dimensions to identify any problems.</p>
</div>
<ul class="simple">
<li>The reproduction map, death map and dispersal map (if provided) must match the dimensions of the fine map. No
coarse map should be provided in these scenarios.</li>
</ul>
</div></blockquote>
</li>
</ul>
<p>An example of how the map files are related is shown below. Black arrows indicate the offsets for the fine map (in the x
and y dimensions) and purple arrows indicate the offsets for the coarse map.</p>
<img alt="Example sample map, fine map and coarse map" src="_images/grid_sample.png" />
</div>
<div class="section" id="infinite-landscapes">
<h4>Infinite Landscapes<a class="headerlink" href="#infinite-landscapes" title="Permalink to this headline">¶</a></h4>
<p>Simulations can also be run on infinite landscapes. Set <code class="docutils literal"><span class="pre">landscape_types=opt</span></code> in
<a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.set_simulation_parameters" title="pycoalescence.simulation.Simulation.set_simulation_parameters"><code class="xref py py-func docutils literal"><span class="pre">set_simulation_parameters()</span></code></a> where <em>opt</em> is one
of the following:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>&#8220;closed&#8221; (default)</dt>
<dd>Run without infinite landscapes, with closed boundaries to the coarse map.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>&#8220;infinite&#8221;</dt>
<dd>Run with a historical infinite landscape outside of the coares map boundaries.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>&#8220;tiled_coarse&#8221;</dt>
<dd>Tile the coarse map infinitely in all dimensions. A coarse map must be provided.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>&#8220;tiled_fine&#8221;</dt>
<dd>Tile the fine map infinitely in all dimensions. No coarse map should be provided.</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="optimising-simulations">
<h4>Optimising Simulations<a class="headerlink" href="#optimising-simulations" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As of version 1.2.6rc35 dynamic resizing of internal objects is implemented. Whilst this does reduce RAM usage
in all scenarios, it also means the optimisation process outlined below only relevent when the major
constraint is the size of the density maps.</p>
</div>
<p>The optimisation process below can reduce RAM usage in systems where the major limitation is that the size of the
density maps is much larger than the number of individuals being simulated. This process has a minor to major impact on
performance, depending on the number of individuals. It will not fix issues with simulations not finishing, only reduce
the RAM requirements.</p>
<p><a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.optimise_ram" title="pycoalescence.simulation.Simulation.optimise_ram"><code class="xref py py-func docutils literal"><span class="pre">optimise_ram()</span></code></a> exists for reducing the RAM requirements of
a simulation. Running the function with a specific RAM limit, in GB, should choose a sample map size and offsets to
minimise the in-memory object sizes. This may have a minor impact on simulation speed, but this is likely negligible.
After the function is run, the <a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation" title="pycoalescence.simulation.Simulation"><code class="xref py py-class docutils literal"><span class="pre">Simulation</span> <span class="pre">class</span></code></a> should have re-defined
the grid x and y dimensions to be the largest size possible to simulate for the required memory. The sample map offsets
from the grid are then also stored, such that the grid encompasses the area with the highest number of individuals.</p>
<p><a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.optimise_ram" title="pycoalescence.simulation.Simulation.optimise_ram"><code class="xref py py-func docutils literal"><span class="pre">optimise_ram()</span></code></a> may take some time to run. However, for a
single set of simulations with the same RAM limit, this function should only need to be completed once. Getting and
setting the optimised solution is therefore possible with
<a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.get_optimised_solution" title="pycoalescence.simulation.Simulation.get_optimised_solution"><code class="xref py py-func docutils literal"><span class="pre">get_optimised_solution()</span></code></a> and
<a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.set_optimised_solution" title="pycoalescence.simulation.Simulation.set_optimised_solution"><code class="xref py py-func docutils literal"><span class="pre">set_optimised_solution()</span></code></a>. The whole procedure is
outlined below.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Detect the RAM-optimised solution</span>
<span class="o">&gt;&gt;</span> <span class="n">sim1</span><span class="o">.</span><span class="n">optimise_ram</span><span class="p">()</span>
<span class="c1"># Get the optimised solution for Simulation object sim1</span>
<span class="o">&gt;&gt;</span> <span class="n">sim1</span><span class="o">.</span><span class="n">get_optimised_solution</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;grid_file_name&#39;</span><span class="p">:</span> <span class="s1">&#39;set&#39;</span><span class="p">,</span>
<span class="s1">&#39;grid_x_size&#39;</span><span class="p">:</span> <span class="mi">5134</span><span class="p">,</span>
<span class="s1">&#39;grid_y_size&#39;</span><span class="p">:</span> <span class="mi">5134</span><span class="p">,</span>
<span class="s1">&#39;sample_x_offset&#39;</span><span class="p">:</span> <span class="mi">8208</span><span class="p">,</span>
<span class="s1">&#39;sample_y_offset&#39;</span><span class="p">:</span> <span class="mi">14877</span><span class="p">}</span>
<span class="c1"># Now set the optimised solution for Simulation object sim2</span>
<span class="o">&gt;&gt;</span> <span class="n">sim2</span><span class="o">.</span><span class="n">set_optimised_solution</span><span class="p">({</span><span class="s1">&#39;grid_file_name&#39;</span><span class="p">:</span> <span class="s1">&#39;set&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;grid_x_size&#39;</span><span class="p">:</span> <span class="mi">5134</span><span class="p">,</span>
                              <span class="s1">&#39;grid_y_size&#39;</span><span class="p">:</span> <span class="mi">5134</span><span class="p">,</span>
                              <span class="s1">&#39;sample_x_offset&#39;</span><span class="p">:</span> <span class="mi">8208</span><span class="p">,</span>
                              <span class="s1">&#39;sample_y_offset&#39;</span><span class="p">:</span> <span class="mi">14877</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="generating-configuration-files">
<h4>Generating Configuration Files<a class="headerlink" href="#generating-configuration-files" title="Permalink to this headline">¶</a></h4>
<p>The default process is to not generate any actual config files - these are instead kept in memory to be passed to C++.
However, the configs can be written to a file using
<a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.write_config" title="pycoalescence.simulation.Simulation.write_config"><code class="xref py py-func docutils literal"><span class="pre">write_config()</span></code></a>, which may be useful for storing simulation
parameters outside of the simulation database.</p>
<p>Example configuration file</p>
<div class="highlight-py"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">main</span><span class="p">]</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">job_type</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">output_directory</span> <span class="o">=</span> <span class="n">output</span><span class="o">/</span>
<span class="n">min_spec_rate</span> <span class="o">=</span> <span class="mf">1e-05</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">deme</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">sample_size</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">max_time</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">dispersal_relative_cost</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">min_species</span> <span class="o">=</span> <span class="mi">1</span>

<span class="p">[</span><span class="n">sample_grid</span><span class="p">]</span>
<span class="n">path</span> <span class="o">=</span> <span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Maps</span><span class="o">/</span><span class="n">maskmap</span><span class="o">.</span><span class="n">tif</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">486</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">517</span>
<span class="n">mask</span> <span class="o">=</span> <span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Maps</span><span class="o">/</span><span class="n">maskmap</span><span class="o">.</span><span class="n">tif</span>

<span class="p">[</span><span class="n">fine_map</span><span class="p">]</span>
<span class="n">path</span> <span class="o">=</span> <span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Maps</span><span class="o">/</span><span class="n">finemap</span><span class="o">.</span><span class="n">tif</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">34000</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">28000</span>
<span class="n">x_off</span> <span class="o">=</span> <span class="mi">17155</span>
<span class="n">y_off</span> <span class="o">=</span> <span class="mi">11178</span>

<span class="p">[</span><span class="n">coarse_map</span><span class="p">]</span>
<span class="n">path</span> <span class="o">=</span> <span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Maps</span><span class="o">/</span><span class="n">coarsemap</span><span class="o">.</span><span class="n">tif</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">24000</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">20000</span>
<span class="n">x_off</span> <span class="o">=</span> <span class="mi">10320</span>
<span class="n">y_off</span> <span class="o">=</span> <span class="mi">7200</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="p">[</span><span class="n">historical_fine0</span><span class="p">]</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">none</span>
<span class="n">number</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">time</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">rate</span> <span class="o">=</span> <span class="mi">0</span>

<span class="p">[</span><span class="n">historical_coarse0</span><span class="p">]</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">none</span>
<span class="n">number</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">time</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">rate</span> <span class="o">=</span> <span class="mi">0</span>

<span class="p">[</span><span class="n">historical_fine1</span><span class="p">]</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">none</span>
<span class="n">number</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">time</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">rate</span> <span class="o">=</span> <span class="mi">0</span>

<span class="p">[</span><span class="n">historical_coarse1</span><span class="p">]</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">none</span>
<span class="n">number</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">time</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">rate</span> <span class="o">=</span> <span class="mi">0</span>

<span class="p">[</span><span class="n">dispersal</span><span class="p">]</span>
<span class="n">method</span> <span class="o">=</span> <span class="n">norm</span><span class="o">-</span><span class="n">uniform</span>
<span class="n">m_probability</span> <span class="o">=</span> <span class="mf">1e-10</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">restrict_self</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">landscape_type</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="post-simulation-analysis">
<h3><a class="toc-backref" href="#id9">Post-simulation analysis</a><a class="headerlink" href="#post-simulation-analysis" title="Permalink to this headline">¶</a></h3>
<p>Once simulations are complete, necsim&#8217;s <a class="reference internal" href="necsim/necsim_library.html#introduction-speciationcounter"><span class="std std-ref">applying speciation rates functionality</span></a>
can be used to apply additional speciation rates to the coalescence tree. A simple way of applying additional simulation
rates is provided within the <a class="reference internal" href="pycoalescence.html#pycoalescence.coalescence_tree.CoalescenceTree" title="pycoalescence.coalescence_tree.CoalescenceTree"><code class="xref py py-class docutils literal"><span class="pre">CoalescenceTree</span> <span class="pre">class</span></code></a>.</p>
<p>The two functions for this routine are</p>
<ul class="simple">
<li><a class="reference internal" href="pycoalescence.html#pycoalescence.coalescence_tree.CoalescenceTree.set_speciation_parameters" title="pycoalescence.coalescence_tree.CoalescenceTree.set_speciation_parameters"><code class="xref py py-func docutils literal"><span class="pre">set_speciation_parameters()</span></code></a> which
primarily takes a list of speciation rates to apply (for other arguments see
<a class="reference internal" href="pycoalescence.html#pycoalescence.coalescence_tree.CoalescenceTree.set_speciation_parameters" title="pycoalescence.coalescence_tree.CoalescenceTree.set_speciation_parameters"><code class="xref py py-func docutils literal"><span class="pre">documentation</span></code></a>.</li>
<li><a class="reference internal" href="pycoalescence.html#pycoalescence.coalescence_tree.CoalescenceTree.apply" title="pycoalescence.coalescence_tree.CoalescenceTree.apply"><code class="xref py py-func docutils literal"><span class="pre">apply()</span></code></a> performs the analysis and writes to the output
file. This can be extremely RAM and time-intensive for simulations of a large number of individuals. The calculations
will be stored in extra tables within the same SQL file as originally specified.</li>
</ul>
<p>Instead of speciation events always contributing a new species, they can instead draw from a metacommunity, simulating
immigration events. There are three methods of providing a metacommunity:</p>
<ul class="simple">
<li>simulate a non-spatial community using a metacommunity size and metacommunity speciation rate parameter to generate
the species abundances from which to draw individuals.</li>
<li>analytically generate the community using an approximation of the above simulation. The same two parameters
(metacommunity size and metacommunity speciation rate) are required.</li>
<li>Supply a database containing a SPECIES_ABUNDANCES table and an external community reference number referring to a
particular generated community within the database.</li>
</ul>
<p>All methods use the same function,
<a class="reference internal" href="pycoalescence.html#pycoalescence.coalescence_tree.CoalescenceTree.set_speciation_parameters" title="pycoalescence.coalescence_tree.CoalescenceTree.set_speciation_parameters"><code class="xref py py-func docutils literal"><span class="pre">set_speciation_parameters()</span></code></a> with
<code class="docutils literal"><span class="pre">option</span></code> set as one of &#8220;simulated&#8221;, &#8220;analytical&#8221; or a path to the external database, respectively for the above
three methods.</p>
<div class="section" id="id4">
<h4>Examples<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>A basic application procedure is</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pycoalescence</span> <span class="kn">import</span> <span class="n">CoalescenceTree</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">CoalescenceTree</span><span class="p">()</span>
<span class="n">speciation_rates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span> <span class="p">,</span><span class="mf">0.3</span><span class="p">]</span>
<span class="n">t</span><span class="o">.</span><span class="n">set_database</span><span class="p">(</span><span class="s2">&quot;output/data_1_1.db&quot;</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">set_speciation_parameters</span><span class="p">(</span><span class="n">speciation_rates</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="pycoalescence.html#pycoalescence.coalescence_tree.CoalescenceTree" title="pycoalescence.coalescence_tree.CoalescenceTree"><code class="xref py py-class docutils literal"><span class="pre">CoalescenceTree</span> <span class="pre">class</span></code></a> object can also be set up from a
<a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation" title="pycoalescence.simulation.Simulation"><code class="xref py py-class docutils literal"><span class="pre">Simulation</span> <span class="pre">class</span></code></a> object as:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pycoalescence</span> <span class="kn">import</span> <span class="n">Simulation</span><span class="p">,</span> <span class="n">CoalescenceTree</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">()</span>
<span class="c1"># ... set up simulation here, then run</span>
<span class="c1"># Now import our completed simulation without needing to run t.set_database(&quot;filepath&quot;)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">CoalescenceTree</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
</pre></div>
</div>
<p>Example application with more complicated parameters</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pycoalescence</span> <span class="kn">import</span> <span class="n">Simulation</span><span class="p">,</span> <span class="n">CoalescenceTree</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">()</span>
<span class="c1"># ... set up simulation here, then run</span>
<span class="c1"># Now import our completed simulation without needing to run t.set_database(&quot;filepath&quot;)</span>
<span class="n">speciation_rates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>
<span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">CoalescenceTree</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">set_speciation_parameters</span><span class="p">(</span><span class="n">speciation_rates</span><span class="o">=</span><span class="n">speciation_rates</span><span class="p">,</span> <span class="n">record_spatial</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="n">record_fragments</span><span class="o">=</span><span class="s2">&quot;path/to/fragments.csv&quot;</span><span class="p">,</span> <span class="n">sample_file</span><span class="o">=</span><span class="s2">&quot;path/to/sample/file.tif&quot;</span><span class="p">,</span>
<span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
</pre></div>
</div>
<p>A few biodiversity metrics can then be obtained directly from the database using built-in functions, relieving the user
of having to generate these manually. These include</p>
<ul class="simple">
<li>species richness, using <a class="reference internal" href="pycoalescence.html#pycoalescence.coalescence_tree.CoalescenceTree.get_species_richness" title="pycoalescence.coalescence_tree.CoalescenceTree.get_species_richness"><code class="xref py py-func docutils literal"><span class="pre">get_species_richness()</span></code></a></li>
<li>species abundances, using <a class="reference internal" href="pycoalescence.html#pycoalescence.coalescence_tree.CoalescenceTree.get_species_abundances" title="pycoalescence.coalescence_tree.CoalescenceTree.get_species_abundances"><code class="xref py py-func docutils literal"><span class="pre">get_species_abundances()</span></code></a></li>
<li>species octave (2^n) classes for generating species abundance distributions,
using <a class="reference internal" href="pycoalescence.html#pycoalescence.coalescence_tree.CoalescenceTree.get_octaves" title="pycoalescence.coalescence_tree.CoalescenceTree.get_octaves"><code class="xref py py-func docutils literal"><span class="pre">get_octaves()</span></code></a></li>
</ul>
<p>Check out other full examples in <a class="reference internal" href="src/examples.html"><span class="doc">this jupyter notebook</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The above functions for acquiring biodiversity metrics require supplying a speciation rate and time,
otherwise will output data for all speciation rates and times.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Equivalent functions also exist for obtaining individual fragment biodiversity metrics.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The entire list of species can be outputted using
<a class="reference internal" href="pycoalescence.html#pycoalescence.coalescence_tree.CoalescenceTree.get_species_list" title="pycoalescence.coalescence_tree.CoalescenceTree.get_species_list"><code class="xref py py-func docutils literal"><span class="pre">get_species_list</span></code></a>. This may be useful
for scenarios where it is desirable to calculate custom biodiversity metrics.</p>
</div>
</div>
</div>
<div class="section" id="extended-analysis">
<h3><a class="toc-backref" href="#id10">Extended analysis</a><a class="headerlink" href="#extended-analysis" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="pycoalescence.html#module-pycoalescence.coalescence_tree" title="pycoalescence.coalescence_tree"><code class="xref py py-mod docutils literal"><span class="pre">coalescence_tree</span></code></a> module can be used for more extensive simulation
analysis, such as comparing simulated landscapes to real data and calculating goodness of fits.</p>
<p>The general procedure for using this module involves a few functions, all contained in the
<a class="reference internal" href="pycoalescence.html#pycoalescence.coalescence_tree.CoalescenceTree" title="pycoalescence.coalescence_tree.CoalescenceTree"><code class="xref py py-class docutils literal"><span class="pre">CoalescenceTree</span> <span class="pre">class</span></code></a>.</p>
<ul class="simple">
<li><a class="reference internal" href="pycoalescence.html#pycoalescence.coalescence_tree.CoalescenceTree.set_database" title="pycoalescence.coalescence_tree.CoalescenceTree.set_database"><code class="xref py py-func docutils literal"><span class="pre">set_database()</span></code></a> generates the link to the SQL
database, which should be an output from a <strong>necsim</strong> simulation (run using the
<a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation" title="pycoalescence.simulation.Simulation"><code class="xref py py-class docutils literal"><span class="pre">Simulation</span> <span class="pre">class</span></code></a>).</li>
<li><a class="reference internal" href="pycoalescence.html#pycoalescence.coalescence_tree.CoalescenceTree.import_comparison_data" title="pycoalescence.coalescence_tree.CoalescenceTree.import_comparison_data"><code class="xref py py-func docutils literal"><span class="pre">import_comparison_data()</span></code></a> reads an
SQL database which contains real data to compare to the simulation output. The comparison data should contain the
following tables:<ul>
<li>BIODIVERSITY_ METRICS, containing <em>only</em> &#8220;metric&#8221;, &#8220;fragment&#8221;, &#8220;value&#8221; and &#8220;number_of_individuals&#8221; columns.
The metric can be &#8220;fragment_richness&#8221; or any other metric created by your own functions which exists also in
the simulated data.</li>
<li>SPECIES_ABUNDANCES containing <em>at least</em> &#8220;SpeciesID&#8221;, &#8220;Abund&#8221;.</li>
</ul>
</li>
</ul>
<p>Additionally, one can provide the following if comparisons between fragments are required:</p>
<blockquote>
<div><ul class="simple">
<li>FRAGMENT_ABUNDANCES containing <em>at least</em> &#8220;Plot&#8221;, &#8220;Mnemonic&#8221; and &#8220;Abund&#8221;.</li>
<li>FRAGMENT_OCTAVES containing <em>at least</em> &#8220;fragment&#8221;, &#8220;octave&#8221;, &#8220;num_species&#8221;. This can also be calculated from
FRAGMENT_ABUNDANCES using <a class="reference internal" href="pycoalescence.html#pycoalescence.coalescence_tree.CoalescenceTree.calculate_comparison_octaves" title="pycoalescence.coalescence_tree.CoalescenceTree.calculate_comparison_octaves"><code class="xref py py-func docutils literal"><span class="pre">calculate_comparison_octaves()</span></code></a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="additional-package-features">
<h3><a class="toc-backref" href="#id11">Additional Package Features</a><a class="headerlink" href="#additional-package-features" title="Permalink to this headline">¶</a></h3>
<p>These features are not required for spatially-explicit coalescence models, as they are utilised internally by the
package. However, there are some features that could be of great convenience to users, especially for generating and
manipulating landscapes using tif files.</p>
<ul class="simple">
<li>Read tif files and perform a number of operations taking into account georeferencing of the data.
Functionality is contained within the <a class="reference internal" href="pycoalescence.html#pycoalescence.map.Map" title="pycoalescence.map.Map"><code class="xref py py-class docutils literal"><span class="pre">Map</span> <span class="pre">class</span></code></a> (see <a class="reference internal" href="README_landscapes.html#map-reading"><span class="std std-ref">here</span></a>).</li>
<li>Generate fragmented landscapes (see <a class="reference internal" href="README_landscapes.html#generate-landscapes"><span class="std std-ref">here</span></a>). This may be useful for generating example
landscapes of a particular size with desired characteristics.</li>
<li>Simulate a dispersal kernel on a landscape to obtain characteristics of the effective dispersal kernel. Currently only
a single map is supported with &#8220;closed&#8221;, &#8220;infinite&#8221; or &#8220;tiled&#8221; landscape types (see <a class="reference internal" href="README_landscapes.html#simulate-landscapes"><span class="std std-ref">here</span></a>).</li>
<li>Simulations can be merged into a single output, with each simulation occupying a separate guild (see
<a class="reference internal" href="README_merger.html#merging-simulations"><span class="std std-ref">here</span></a>). Analyses can then be performed on the combined data.</li>
</ul>
</div>
<div class="section" id="testing-install">
<h3><a class="toc-backref" href="#id12">Testing install</a><a class="headerlink" href="#testing-install" title="Permalink to this headline">¶</a></h3>
<p>The system install can be tested by running <code class="xref py py-mod docutils literal"><span class="pre">test_install.py</span></code> from the command line
(<code class="docutils literal"><span class="pre">python</span> <span class="pre">test_install.py</span></code>) which requires that <code class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span></code> has been successfully run previously or the package
otherwise successfully installed.</p>
</div>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<div class="section" id="essential">
<h3>Essential<a class="headerlink" href="#essential" title="Permalink to this headline">¶</a></h3>
<p>Note that conda should detect and install all prerequisites automatically. Pip will detect and install Python
prerequisites (such as numpy), although on some systems will fail to install gdal.</p>
<ul class="simple">
<li>Python version 2 &gt;= 2.7.9 or 3 &gt;= 3.4.1. Other versions may work, but are not supported.</li>
<li>C++ compiler (such as GNU g++) with C++14 support.</li>
<li><a class="reference external" href="https://cmake.org/">Cmake</a> &gt;= 3.6 for installing via pip or conda.</li>
<li><a class="reference external" href="https://www.sqlite.org/download.html">The SQLite library</a> for both <code class="docutils literal"><span class="pre">C++</span></code> and <code class="docutils literal"><span class="pre">Python</span></code>
installations. Comes as standard with Python.</li>
<li>The gdal library for both Python and C++ (<a class="reference external" href="http://www.gdal.org/">available here</a>). Although it is possible to turn
off gdal support, this is not recommended as it is essential if you wish to use .tif files for
<a class="reference internal" href="necsim/necsim_library.html#introduction-necsim"><span class="std std-ref">necsim</span></a>.  It allows reading parameter information from .tif files (using
<a class="reference internal" href="pycoalescence.html#pycoalescence.simulation.Simulation.detect_map_dimensions" title="pycoalescence.simulation.Simulation.detect_map_dimensions"><code class="xref py py-func docutils literal"><span class="pre">detect_map_dimensions()</span></code></a>). Both the Python package
and <code class="docutils literal"><span class="pre">C++</span></code> binaries are required; installation differs between systems, so view the gdal documentation for more
help installing gdal properly.</li>
<li>The Boost library for C++ available <a class="reference external" href="http://www.boost.org">here</a>.</li>
<li>Numerical Python (<code class="docutils literal"><span class="pre">numpy</span></code>) package (<code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">numpy</span></code>).</li>
</ul>
</div>
<div class="section" id="recommended">
<h3>Recommended<a class="headerlink" href="#recommended" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>For work involving large csv files, the fast-cpp-csv-parser by Ben Strasser, available
<a class="reference external" href="https://github.com/ben-strasser/fast-cpp-csv-parser">here</a> is recommended. This provides much faster csv read and
write capabilities and is probably essential for larger-scale simulations, but not necessary if your simulations are
small or you are intending to use <em>.tif</em> files (the recommended method). The folder
<em>fast-cpp-csv-parser/</em> should be in the same directory as your <strong>necsim</strong> C++ header files (the lib/necsim directory)
and requires manual installation.</li>
<li>Scipy package for generating fragmented landscapes (<code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">scipy</span></code>).</li>
<li>Matplotlib package for plotting fragmented landscapes (<code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">matplotlib</span></code>).</li>
</ul>
</div>
</div>
<div class="section" id="glossary">
<h2>Glossary<a class="headerlink" href="#glossary" title="Permalink to this headline">¶</a></h2>
<dl class="glossary docutils">
<dt id="term-grid">grid</dt>
<dd>Used to refer to the simulation area that is stored in memory as a matrix, for quick referencing. If no RAM
optimisations have been performed, this will be the same size as the sample map. If also no sample map is used,
this will be the same as the fine map.</dd>
<dt id="term-sample-map">sample map</dt>
<dd>The map file containing the points to be sampled from. This is the most zoomed in level of the simulation, and
should encompass all starting locations of lineages.</dd>
<dt id="term-fine-map">fine map</dt>
<dd>The map file at a higher resolution (the same as the sample grid) which covers the area lineages are most likely
to move to, or where a higher spatial resolution is considered important.</dd>
<dt id="term-coarse-map">coarse map</dt>
<dd>The map file at a lower resolution (specified by the scale) which covers a larger area than the fine map. This
is to allow lineages to move far from their starting positions if required.</dd>
<dt id="term-historical-map">historical map</dt>
<dd>A historic map containing population densities at those times. Both fine and coarse historical maps can be
declared and multiple sets of pristine maps can be declared at unique times.</dd>
</dl>
</div>
<div class="section" id="version">
<h2>Version<a class="headerlink" href="#version" title="Permalink to this headline">¶</a></h2>
<p>Version 1.2.7a2</p>
</div>
<div class="section" id="contacts">
<h2>Contacts<a class="headerlink" href="#contacts" title="Permalink to this headline">¶</a></h2>
<p>Author: Samuel Thompson</p>
<p>Contact: <a class="reference external" href="mailto:samuelthompson14&#37;&#52;&#48;imperial&#46;ac&#46;uk">samuelthompson14<span>&#64;</span>imperial<span>&#46;</span>ac<span>&#46;</span>uk</a> - <a class="reference external" href="mailto:thompsonsed&#37;&#52;&#48;gmail&#46;com">thompsonsed<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
<p>Institution: Imperial College London and National University of Singapore</p>
<p>This project is released under MIT See file
<strong>LICENSE.txt</strong> or go to
<a class="reference external" href="https://opensource.org/licenses/MIT">here</a> for full license
details.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/PyCoal_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">pycoalescence</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#getting-started">Getting started</a><ul>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#installing-via-conda">Installing via conda</a><ul>
<li><a class="reference internal" href="#conda-on-linux">conda on Linux</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installing-via-pip">Installing via pip</a></li>
<li><a class="reference internal" href="#installing-manually-setuptools">Installing manually - setuptools</a></li>
<li><a class="reference internal" href="#installing-manually-installer-py">Installing manually - installer.py</a></li>
<li><a class="reference internal" href="#hpc-installation">HPC installation</a></li>
<li><a class="reference internal" href="#installation-issues">Installation issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#performing-simulations">Performing simulations</a><ul>
<li><a class="reference internal" href="#setting-up-simulations">Setting up simulations</a></li>
<li><a class="reference internal" href="#key-features">Key Features</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#dispersal-kernels">Dispersal Kernels</a></li>
<li><a class="reference internal" href="#differing-demographic-rates">Differing demographic rates</a></li>
<li><a class="reference internal" href="#limitations-of-simulation-variables">Limitations of simulation variables</a></li>
<li><a class="reference internal" href="#infinite-landscapes">Infinite Landscapes</a></li>
<li><a class="reference internal" href="#optimising-simulations">Optimising Simulations</a></li>
<li><a class="reference internal" href="#generating-configuration-files">Generating Configuration Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#post-simulation-analysis">Post-simulation analysis</a><ul>
<li><a class="reference internal" href="#id4">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extended-analysis">Extended analysis</a></li>
<li><a class="reference internal" href="#additional-package-features">Additional Package Features</a></li>
<li><a class="reference internal" href="#testing-install">Testing install</a></li>
</ul>
</li>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a><ul>
<li><a class="reference internal" href="#essential">Essential</a></li>
<li><a class="reference internal" href="#recommended">Recommended</a></li>
</ul>
</li>
<li><a class="reference internal" href="#glossary">Glossary</a></li>
<li><a class="reference internal" href="#version">Version</a></li>
<li><a class="reference internal" href="#contacts">Contacts</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to pycoalescence</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="necsim/necsim_library.html"
                        title="next chapter">necsim</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/README_pycoalescence.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="necsim/necsim_library.html" title="necsim"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to pycoalescence"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pycoalescence 1.2.7a2 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright Copyright 2016, pycoalescence.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
  </body>
</html>